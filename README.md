# ğŸ±ğŸ¶ Cat-Dog-Classification

![cat_vs_dog](./img/cat_vs_dog.png)

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

ä½ æ˜¯å¦æ›¾ç»å¥½å¥‡è¿‡ï¼Œè®¡ç®—æœºæ˜¯å¦‚ä½•åƒäººç±»ä¸€æ ·è¯†åˆ«å›¾ç‰‡ä¸­çš„çŒ«å’Œç‹—ï¼Ÿè¿™ä¸ªé¡¹ç›®å°†å¸¦ä½ æ·±å…¥æ¢ç´¢å›¾åƒåˆ†ç±»çš„å¥‡å¦™ä¸–ç•Œï¼

è¿™æ˜¯ä¸€ä¸ª**å…¨é¢è€Œæœ‰è¶£**çš„ğŸ±ğŸ¶çŒ«ç‹—å›¾åƒåˆ†ç±»é¡¹ç›®ï¼Œå®ƒä¸ä»…å®ç°äº†å¤šç§ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œè¿˜åŒ…å«äº†æ·±åº¦å­¦ä¹ å·ç§¯ç¥ç»ç½‘ç»œçš„å®Œæ•´å®ç°ã€‚æ— è®ºä½ æ˜¯æƒ³æ¢ç´¢ç‰¹å¾å·¥ç¨‹ã€åˆæ­¥å­¦ä¹ æ·±åº¦å­¦ä¹ ï¼Œè¿˜æ˜¯æƒ³å¿«é€Ÿæ­å»ºä¸€ä¸ªå®ç”¨çš„å›¾åƒåˆ†ç±»ç³»ç»Ÿï¼Œè¿™ä¸ªé¡¹ç›®éƒ½èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ã€‚

**ğŸŒŸ é¡¹ç›®äº®ç‚¹**

- **ğŸ“Š ä¼ ç»Ÿ ML æ¨¡å‹**ï¼šæ”¯æŒå‘é‡æœº(SVM)ã€é€»è¾‘å›å½’(logistic regression)ã€éšæœºæ£®æ—(random forest)ï¼Œé…åˆ 10 ç§ä¸åŒçš„æ‰‹å·¥ç‰¹å¾æå–
- **ğŸ¯ é›†æˆå­¦ä¹ **ï¼šæŠ•ç¥¨é›†æˆ(voting)ã€å †å æ³›åŒ–(stacking)ã€è‡ªé€‚åº”å¢å¼º(AdaBoost)
- **ğŸ”¥ æ·±åº¦å­¦ä¹ æ¨¡å‹**ï¼šè‡ªå®šä¹‰ CNNï¼ŒResNet18/34/50ï¼Œæ”¯æŒç«¯åˆ°ç«¯è®­ç»ƒ
- **ğŸ” æ™ºèƒ½ç‰¹å¾æœç´¢**ï¼šä½¿ç”¨æŸæœç´¢ç®—æ³•(Beam Search)è‡ªåŠ¨å¯»æ‰¾æœ€ä¼˜ç‰¹å¾ç»„åˆ
- **ğŸŒ Web ç•Œé¢**ï¼šåŸºäº Gradio çš„å‹å¥½äº¤äº’ç•Œé¢ï¼Œæ”¯æŒå®æ—¶å›¾åƒåˆ†ç±»
- **ğŸ“ˆ å®Œæ•´å¯è§†åŒ–**ï¼šTensorBoard æ”¯æŒã€è‡ªåŠ¨ç”Ÿæˆè®­ç»ƒæŠ¥å‘Šå’Œæ€§èƒ½åˆ†æå›¾è¡¨

å¦‚æœä½ æ˜¯æœºå™¨å­¦ä¹ åˆå­¦è€…ï¼Œè¿™ä¸ªé¡¹ç›®å¯ä»¥æä¾›å®è´µçš„å®è·µç»éªŒï¼Œè®©æˆ‘ä»¬ä¸€èµ·ç”¨ä»£ç æ•™ä¼šè®¡ç®—æœºè¯†åˆ«è¿™äº›å¯çˆ±çš„æ¯›èŒ¸èŒ¸æœ‹å‹ä»¬å§ï¼âœ¨

## ğŸ“‘ ç›®å½•

- [ğŸ±ğŸ¶ Cat-Dog-Classification](#-cat-dog-classification)
  - [ğŸ“‹ é¡¹ç›®ç®€ä»‹](#-é¡¹ç›®ç®€ä»‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [ğŸ“ é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)
  - [ğŸš€ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
    - [âš™ï¸ ç¯å¢ƒé…ç½®](#ï¸-ç¯å¢ƒé…ç½®)
      - [åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ](#åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ)
      - [å®‰è£…ä¾èµ–](#å®‰è£…ä¾èµ–)
      - [éªŒè¯å®‰è£…](#éªŒè¯å®‰è£…)
    - [ğŸ“¦ æ•°æ®é›†å‡†å¤‡](#-æ•°æ®é›†å‡†å¤‡)
    - [ğŸ¤– ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ–¹æ³•](#-ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ–¹æ³•)
      - [ç‰¹å¾å·¥ç¨‹](#ç‰¹å¾å·¥ç¨‹)
      - [åŸºç¡€æ¨¡å‹è®­ç»ƒ](#åŸºç¡€æ¨¡å‹è®­ç»ƒ)
      - [è®­ç»ƒç»“æœ](#è®­ç»ƒç»“æœ)
      - [é›†æˆå­¦ä¹ ](#é›†æˆå­¦ä¹ )
    - [ğŸ”¥ æ·±åº¦å­¦ä¹ æ–¹æ³•](#-æ·±åº¦å­¦ä¹ æ–¹æ³•)
      - [æ•°æ®å¢å¼º](#æ•°æ®å¢å¼º)
      - [æ¨¡å‹è®­ç»ƒ](#æ¨¡å‹è®­ç»ƒ)
      - [è®­ç»ƒç»“æœ](#è®­ç»ƒç»“æœ-1)
      - [æ¨ç†é¢„æµ‹](#æ¨ç†é¢„æµ‹)
  - [ğŸ¨ å¯è§†åŒ–](#-å¯è§†åŒ–)
    - [ğŸ“Š è‡ªåŠ¨ç”Ÿæˆçš„å¯è§†åŒ–](#-è‡ªåŠ¨ç”Ÿæˆçš„å¯è§†åŒ–)
    - [ğŸ“ˆ TensorBoard å¯è§†åŒ–](#-tensorboard-å¯è§†åŒ–)
    - [ğŸŒ Web ç•Œé¢](#-web-ç•Œé¢)
  - [ğŸ“§ è”ç³»æ–¹å¼](#-è”ç³»æ–¹å¼)

## ğŸ“ é¡¹ç›®ç»“æ„

```
Cat_Dog_Classification/
â”œâ”€â”€ dataset/
â”‚   â”œâ”€â”€ train/                     # è®­ç»ƒé›†
â”‚   â”‚   â”œâ”€â”€ cats/
â”‚   â”‚   â””â”€â”€ dogs/
â”‚   â”œâ”€â”€ val/                       # éªŒè¯é›†
â”‚   â””â”€â”€ test/                      # æµ‹è¯•é›†
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ data_utils.py          # æ•°æ®åŠ è½½å’Œé¢„å¤„ç†
â”‚   â”‚   â”œâ”€â”€ feature_extraction.py  # ç‰¹å¾æå–
â”‚   â”‚   â””â”€â”€ feature_search.py      # ç‰¹å¾æœç´¢
â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”œâ”€â”€ hog.py                 # HOG ç‰¹å¾
â”‚   â”‚   â”œâ”€â”€ color_hist.py          # é¢œè‰²ç›´æ–¹å›¾
â”‚   â”‚   â”œâ”€â”€ lbp.py                 # LBP ç‰¹å¾
â”‚   â”‚   â”œâ”€â”€ glcm.py                # GLCM çº¹ç†ç‰¹å¾
â”‚   â”‚   â”œâ”€â”€ gabor.py               # Gabor æ»¤æ³¢å™¨
â”‚   â”‚   â””â”€â”€ ...                    # å…¶ä»–ç‰¹å¾
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ cnn.py                 # CNN æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ resnet.py              # ResNet æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ svm.py                 # SVM æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ logistic_regression.py # é€»è¾‘å›å½’
â”‚   â”‚   â””â”€â”€ random_forest.py       # éšæœºæ£®æ—
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ config.py              # é…ç½®ç®¡ç†
â”‚       â”œâ”€â”€ torch_training.py      # PyTorch è®­ç»ƒå·¥å…·
â”‚       â”œâ”€â”€ ml_training.py         # ä¼ ç»Ÿ ML è®­ç»ƒå·¥å…·
â”‚       â”œâ”€â”€ inference_utils.py     # æ¨ç†å·¥å…·
â”‚       â””â”€â”€ logger.py              # æ—¥å¿—å·¥å…·
â”‚
â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ visualization.py           # å¯è§†åŒ–å·¥å…·
â”‚   â”œâ”€â”€ reporting.py               # æŠ¥å‘Šç”Ÿæˆ
â”‚   â””â”€â”€ check_gpu_cuda.py          # GPU æ£€æŸ¥
â”‚
â”œâ”€â”€ runs/
â”‚   â”œâ”€â”€ torch_resnet34_*/          # ResNet34 è®­ç»ƒç»“æœ
â”‚   â”œâ”€â”€ torch_resnet18_*/          # ResNet18 è®­ç»ƒç»“æœ
â”‚   â”œâ”€â”€ torch_cnn-*/               # CNN è®­ç»ƒç»“æœ
â”‚   â”œâ”€â”€ sklearn_*/                 # sklearn æ¨¡å‹ç»“æœ
â”‚   â””â”€â”€ ensemble_*/                # é›†æˆå­¦ä¹ ç»“æœ
â”‚
â”œâ”€â”€ weights/                       # é¢„è®­ç»ƒæƒé‡
â”‚
â”œâ”€â”€ train_torch.py                 # PyTorch è®­ç»ƒå…¥å£
â”œâ”€â”€ train_sklearn.py               # sklearn è®­ç»ƒå…¥å£
â”œâ”€â”€ ensemble.py                    # é›†æˆå­¦ä¹ è„šæœ¬
â”œâ”€â”€ infer.py                       # æ¨ç†è„šæœ¬
â”œâ”€â”€ gradio_run.py                  # Gradio Web ç•Œé¢
â”œâ”€â”€ requirements.txt               # Python ä¾èµ–
â”œâ”€â”€ LICENSE                        # è®¸å¯è¯
â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### âš™ï¸ ç¯å¢ƒé…ç½®

#### åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
# ä½¿ç”¨ conda
conda create -n catdog python=3.11
conda activate catdog

# æˆ–ä½¿ç”¨ venv
python -m venv venv
source venv/bin/activate  # Linux/macOS
# æˆ–
venv\Scripts\activate  # Windows
```

#### å®‰è£…ä¾èµ–

```bash
# å®‰è£…ä¸æœ¬åœ°cudaç‰ˆæœ¬å¯¹åº”çš„ PyTorchï¼Œè®¿é—® https://pytorch.org/ è·å–æ­£ç¡®çš„å®‰è£…å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š
pip install torch==2.6.0 torchvision==0.21.0 torchaudio==2.6.0 --index-url https://download.pytorch.org/whl/cu126

# å®‰è£…åŸºç¡€ä¾èµ–
pip install -r requirements.txt
```

#### éªŒè¯å®‰è£…

```bash
# æ£€æŸ¥ GPU æ˜¯å¦å¯ç”¨
python tools/check_gpu_cuda.py
```

### ğŸ“¦ æ•°æ®é›†å‡†å¤‡

æœ¬é¡¹ç›®ä½¿ç”¨çš„æ•°æ®é›†å¯ä»¥ä»ä»¥ä¸‹åœ°å€ä¸‹è½½ï¼š[Cat-and-Dog](https://www.kaggle.com/datasets/tongpython/cat-and-dog)ã€‚

ä¸‹è½½åï¼Œå°†æ•°æ®é›†æŒ‰ä»¥ä¸‹ç»“æ„ç»„ç»‡ï¼š

```
dataset/
â”œâ”€â”€ train/              # è®­ç»ƒé›†
â”‚   â”œâ”€â”€ cats/           # çŒ«çš„å›¾ç‰‡
â”‚   â””â”€â”€ dogs/           # ç‹—çš„å›¾ç‰‡
â”œâ”€â”€ val/                # éªŒè¯é›†
â”‚   â”œâ”€â”€ cats/
â”‚   â””â”€â”€ dogs/
â””â”€â”€ test/               # æµ‹è¯•é›†
    â”œâ”€â”€ cats/
    â””â”€â”€ dogs/
```

å…¶ä¸­ï¼Œè®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†çš„æ¯”ä¾‹ä¸º $8:1:1$

### ğŸ¤– ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ–¹æ³•

#### ç‰¹å¾å·¥ç¨‹

ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ¨¡å‹ä¾èµ–ç‰¹å¾å·¥ç¨‹ï¼Œæœ¬é¡¹ç›®å®ç°äº†å¤šç§ç‰¹å¾æå–æ–¹æ³•(ä»¥ç¼©æ”¾åˆ° $128 \times 128$ çš„å›¾åƒä¸ºä¾‹)ï¼š

| ç‰¹å¾ç±»å‹  | è¯´æ˜ | ç»´åº¦ | ç”¨é€” |
| ------ | -----  | ----- | ----- |
| **HOG** | æ–¹å‘æ¢¯åº¦ç›´æ–¹å›¾ï¼Œæ•è·è¾¹ç¼˜å’Œå½¢çŠ¶ä¿¡æ¯ | 1764 | ä¸»è¦ç‰¹å¾ |
| **é¢œè‰²ç›´æ–¹å›¾** | RGB/HSV é¢œè‰²åˆ†å¸ƒ | 512 | é¢œè‰²ç‰¹å¾ |
| **SIFT** | å°ºåº¦ä¸å˜ç‰¹å¾å˜æ¢ | 291 | å…³é”®ç‚¹ç‰¹å¾ |
| **Gabor** | Gabor æ»¤æ³¢å™¨å“åº” | 64 | å¤šå°ºåº¦çº¹ç† |
| **è¾¹ç¼˜ç›´æ–¹å›¾** | è¾¹ç¼˜æ–¹å‘åˆ†å¸ƒ | 42 | è¾¹ç¼˜ç‰¹å¾ |
| **LBP** | å±€éƒ¨äºŒå€¼æ¨¡å¼ï¼Œçº¹ç†ç‰¹å¾ | 10 | çº¹ç†åˆ†æ |
| **é¢œè‰²çŸ©** | é¢œè‰²é€šé“çš„å‡å€¼ã€æ ‡å‡†å·®ã€ååº¦ | 9 | é¢œè‰²ç‰¹å¾ |
| **Hu ä¸å˜çŸ©** | å›¾åƒå½¢çŠ¶ä¸å˜çŸ© | 7 | å½¢çŠ¶ç‰¹å¾ |
| **è§’ç‚¹è¾¹ç¼˜å¯†åº¦** | è§’ç‚¹å’Œè¾¹ç¼˜å¯†åº¦ç»Ÿè®¡ | 7 | ç»“æ„ç‰¹å¾ |
| **GLCM** | ç°åº¦å…±ç”ŸçŸ©é˜µï¼Œçº¹ç†ç»Ÿè®¡ | 6 | çº¹ç†ç‰¹å¾ |

ä¸ºæ‰¾åˆ°æœ€ä¼˜çš„ç‰¹å¾ç»„åˆï¼Œæœ¬é¡¹ç›®ä½¿ç”¨äº† **æŸæœç´¢ï¼ˆBeam Searchï¼‰** ç®—æ³•è‡ªåŠ¨å¯¹ç‰¹å¾ç»„åˆè¿›è¡Œæœç´¢ï¼Œå¸®åŠ©æå‡ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ¨¡å‹çš„æ€§èƒ½ã€‚

> ğŸ’¡ **æç¤º**ï¼šç‰¹å¾æœç´¢ä¸»è¦ç”¨äºä¼ ç»Ÿæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå»ºè®®åœ¨è®­ç»ƒä¼ ç»Ÿ ML æ¨¡å‹ä¹‹å‰å…ˆè¿è¡Œç‰¹å¾æœç´¢ï¼Œæ‰¾åˆ°æœ€ä½³ç‰¹å¾ç»„åˆã€‚

**åŠŸèƒ½ç‰¹ç‚¹ï¼š**

- ğŸ” **æŸæœç´¢ç®—æ³•**ï¼šé«˜æ•ˆæœç´¢æœ€ä¼˜ç‰¹å¾ç»„åˆ
- ğŸ“Š **äº¤å‰éªŒè¯è¯„ä¼°**ï¼šä½¿ç”¨ 5 æŠ˜äº¤å‰éªŒè¯è¯„ä¼°ç‰¹å¾ç»„åˆæ€§èƒ½
- ğŸ¯ **è‡ªåŠ¨ç‰¹å¾é€‰æ‹©**ï¼šä» 10 ç§ç‰¹å¾ä¸­è‡ªåŠ¨é€‰æ‹©æœ€ä½³ç»„åˆ
- ğŸ“‰ **PCA é™ç»´**ï¼šè‡ªåŠ¨å¤„ç†é«˜ç»´ç‰¹å¾ï¼Œä½¿ç”¨ PCA é™ç»´åˆ° 512 ç»´
- ğŸ’¾ **ç»“æœä¿å­˜**ï¼šè‡ªåŠ¨ä¿å­˜æœç´¢å†å²å’Œæœ€ä½³ç»“æœ

**ä½¿ç”¨æ–¹æ³•ï¼š**

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®ï¼ˆæ¨èï¼‰
python src/data/feature_search.py

# è‡ªå®šä¹‰é…ç½®ï¼ˆè¯¦è§ä»£ç ï¼‰
python src/data/feature_search.py \
    --model svm \
    --cv 5 \
    --sample_ratio 0.8 \
    --pca-components 512 \
    --n_jobs 16 \
    --beam-width 5 \
    --out-dir runs/feature_search
```

**æœç´¢è¿‡ç¨‹**ï¼š
- ç¬¬ 1 æ­¥ï¼šè¯„ä¼° 10 ä¸ªå•ç‰¹å¾ï¼Œä¿ç•™ top 5
- ç¬¬ 2 æ­¥ï¼šæ‰©å±•ä¸º 2 ç‰¹å¾ç»„åˆï¼Œè¯„ä¼° 35 ä¸ªç»„åˆ
- ç¬¬ 3-8 æ­¥ï¼šé€æ­¥å¢åŠ ç‰¹å¾æ•°é‡ï¼Œæœ€ç»ˆæ‰¾åˆ° 8 ç‰¹å¾æœ€ä¼˜ç»„åˆ
- æ€»è¯„ä¼°æ¬¡æ•°ï¼šçº¦ 200+ ä¸ªç‰¹å¾ç»„åˆ
> æ³¨ï¼šé€šè¿‡`pca-components`å‚æ•°è®¾ç½®PCAé™ç»´ï¼ˆé»˜è®¤ä¸º512ï¼‰ï¼Œå³è‹¥ç‰¹å¾ç»„åˆæ€»ç»´æ•° > 512ï¼Œåˆ™è‡ªåŠ¨è°ƒç”¨PCAé™ç»´åˆ°512ï¼›å¦åˆ™ä¸è°ƒç”¨ã€‚

**å•ç‰¹å¾å¾—åˆ†æ’å**ï¼š
1. ğŸ¥‡ **HOG**ï¼ˆæ–¹å‘æ¢¯åº¦ç›´æ–¹å›¾ï¼‰- 77.07% Â± 1.36%
2. ğŸ¥ˆ **SIFT**ï¼ˆå°ºåº¦ä¸å˜ç‰¹å¾å˜æ¢ï¼‰- 70.82% Â± 1.47%
3. ğŸ¥‰ **Edge Histogram**ï¼ˆè¾¹ç¼˜ç›´æ–¹å›¾ï¼‰- 64.47% Â± 1.19%
4. **LBP**ï¼ˆå±€éƒ¨äºŒå€¼æ¨¡å¼ï¼‰- 63.98% Â± 0.93%
5. **GLCM**ï¼ˆç°åº¦å…±ç”ŸçŸ©é˜µï¼‰- 63.46% Â± 1.27%
6. **Corner Edge**ï¼ˆè§’ç‚¹è¾¹ç¼˜å¯†åº¦ï¼‰- 62.97% Â± 0.91%
7. **Gabor**ï¼ˆGabor æ»¤æ³¢å™¨ï¼‰- 62.91% Â± 1.02%
8. **Color Hist**ï¼ˆé¢œè‰²ç›´æ–¹å›¾ï¼‰- 62.36% Â± 0.71%
9. **Color Moments**ï¼ˆé¢œè‰²çŸ©ï¼‰- 61.02% Â± 1.26%
10. **Hu Moments**ï¼ˆHu ä¸å˜çŸ©ï¼‰- 54.47% Â± 0.93%

æ ¹æ®å®éªŒï¼Œ**æœ€ä½³ç‰¹å¾ç»„åˆ**ä¸º color_hist + corner_edge + edge_hist + gabor + glcm + hog + lbp + siftï¼Œå¾—åˆ†ï¼š**80.14% Â± 1.08%**ã€‚

ç‰¹å¾æœç´¢å®Œæˆåï¼Œä¼šåœ¨è¾“å‡ºç›®å½•ç”Ÿæˆï¼š
- `search_results.json` - æœç´¢ç»“æœï¼ˆæœ€ä½³ç»„åˆã€æœç´¢å†å²ã€ç‰¹å¾ä¿¡æ¯ï¼‰
- `feature_search.log` - è¯¦ç»†æœç´¢æ—¥å¿—

ä¹‹åï¼Œä¼šè‡ªåŠ¨ä»¥æœç´¢åˆ°çš„æœ€ä½³ç»„åˆå¯¹å®Œæ•´æ•°æ®é›†è¿›è¡Œç‰¹å¾æå–ï¼Œå¹¶å°†ç‰¹å¾æ–‡ä»¶ä¿å­˜åœ¨`features`ç›®å½•ä¸‹ã€‚

#### åŸºç¡€æ¨¡å‹è®­ç»ƒ

**è¶…å‚æ•°æœç´¢**

æ‰€æœ‰ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ¨¡å‹éƒ½æ”¯æŒ**è‡ªåŠ¨è¶…å‚æ•°æœç´¢**ï¼Œä½¿ç”¨ `GridSearchCV` å’Œ **5æŠ˜äº¤å‰éªŒè¯**æ¥æ‰¾åˆ°æœ€ä½³è¶…å‚æ•°ç»„åˆã€‚è®­ç»ƒè¿‡ç¨‹ä¼šè‡ªåŠ¨è¯„ä¼°å¤šä¸ªå‚æ•°ç»„åˆï¼Œé€‰æ‹©äº¤å‰éªŒè¯å¾—åˆ†æœ€é«˜çš„é…ç½®ã€‚

**SVMï¼ˆæ”¯æŒå‘é‡æœºï¼‰å‚æ•°æœç´¢ï¼š**

<table>
    <thead>
        <tr>
            <th>æœç´¢å‚æ•°</th>
            <th>é»˜è®¤æœç´¢èŒƒå›´</th>
            <th>æœ€ä½³å‚æ•°ç¤ºä¾‹</th>
            <th>CVå‡†ç¡®ç‡</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>C</code>ï¼ˆæ­£åˆ™åŒ–å¼ºåº¦ï¼‰</td>
            <td>[0.1, 1.0, 10.0, 100.0]</td>
            <td>10.0</td>
            <td rowspan="2">80.71% Â± 1.45%</td>
        </tr>
        <tr>
            <td><code>gamma</code>ï¼ˆRBFæ ¸å‚æ•°ï¼‰</td>
            <td>['scale', 0.001, 0.0001]</td>
            <td>'scale'</td>
        </tr>
    </tbody>
</table>

**é€»è¾‘å›å½’å‚æ•°æœç´¢ï¼š**

<table>
    <thead>
        <tr>
        <th>æœç´¢å‚æ•°</th>
        <th>é»˜è®¤æœç´¢èŒƒå›´</th>
        <th>æœ€ä½³å‚æ•°ç¤ºä¾‹</th>
        <th>CVå‡†ç¡®ç‡</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>C</code>ï¼ˆæ­£åˆ™åŒ–å¼ºåº¦ï¼‰</td>
            <td>[0.001, 0.01, 0.1, 1.0, 10.0, 100.0]</td>
            <td>0.1</td>
            <td rowspan="3">77.94% Â± 1.35%</td>
        </tr>
        <tr>
            <td><code>penalty</code>ï¼ˆæ­£åˆ™åŒ–ç±»å‹ï¼‰</td>
            <td>['l1', 'l2']</td>
            <td>'l1'</td>
        </tr>
        <tr>
            <td><code>solver</code>ï¼ˆæ±‚è§£å™¨ï¼‰</td>
            <td>['liblinear', 'lbfgs', 'saga']</td>
            <td>'liblinear'</td>
        </tr>
    </tbody>
</table>

**éšæœºæ£®æ—å‚æ•°æœç´¢ï¼š**

<table>
    <thead>
        <tr>
        <th>æœç´¢å‚æ•°</th>
        <th>é»˜è®¤æœç´¢èŒƒå›´</th>
        <th>æœ€ä½³å‚æ•°ç¤ºä¾‹</th>
        <th>CVå‡†ç¡®ç‡</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>n_estimators</code>ï¼ˆæ ‘æ•°é‡ï¼‰</td>
            <td>[200, 300, 500]</td>
            <td>500</td>
            <td rowspan="5">74.30% Â± 1.15%</td>
        </tr>
        <tr>
            <td><code>max_depth</code>ï¼ˆæœ€å¤§æ·±åº¦ï¼‰</td>
            <td>[10, 15, 20, 30]</td>
            <td>15</td>
        </tr>
        <tr>
            <td><code>min_samples_split</code>ï¼ˆæœ€å°åˆ†è£‚æ ·æœ¬æ•°ï¼‰</td>
            <td>[5, 10, 20]</td>
            <td>20</td>
        </tr>
        <tr>
            <td><code>min_samples_leaf</code>ï¼ˆå¶å­èŠ‚ç‚¹æœ€å°æ ·æœ¬æ•°ï¼‰</td>
            <td>[2, 4, 8]</td>
            <td>2</td>
        </tr>
        <tr>
            <td><code>max_features</code>ï¼ˆç‰¹å¾é€‰æ‹©ç­–ç•¥ï¼‰</td>
            <td>['sqrt', 'log2']</td>
            <td>'sqrt'</td>
        </tr>
    </tbody>
</table>

**è‡ªå®šä¹‰æœç´¢èŒƒå›´ï¼š**

```bash
# SVM - è‡ªå®šä¹‰Cå’Œgammaæœç´¢èŒƒå›´
python train_sklearn.py --model svm \
    --svm-c-values 0.1 1.0 10.0 100.0 1000.0 \
    --svm-gamma-values scale 0.001 0.0001 0.00001

# é€»è¾‘å›å½’ - è‡ªå®šä¹‰æœç´¢å‚æ•°
python train_sklearn.py --model logreg \
    --lr-c-values 0.01 0.1 1.0 10.0 \
    --lr-penalty-types l1 l2 \
    --lr-solvers liblinear saga

# éšæœºæ£®æ— - è‡ªå®šä¹‰æœç´¢èŒƒå›´
python train_sklearn.py --model random_forest \
    --rf-n-estimators 100 200 300 500 \
    --rf-max-depth 10 15 20 25 30 \
    --rf-min-samples-split 5 10 15 20
```

**ç¦ç”¨å‚æ•°æœç´¢ï¼ˆä½¿ç”¨é»˜è®¤å‚æ•°ï¼‰ï¼š**

å¦‚æœä¸æƒ³è¿›è¡Œå‚æ•°æœç´¢ï¼Œå¯ä»¥ä½¿ç”¨ `--no-search` å‚æ•°ç›´æ¥ä½¿ç”¨é»˜è®¤é…ç½®è®­ç»ƒï¼š

```bash
# ä½¿ç”¨é»˜è®¤å‚æ•°è®­ç»ƒï¼ˆä¸è¿›è¡Œæœç´¢ï¼‰
python train_sklearn.py --model svm --no-search

# ä½¿ç”¨è‡ªå®šä¹‰é»˜è®¤å‚æ•°è®­ç»ƒ
python train_sklearn.py --model svm --no-search \
    --svm-default-c 10.0 \
    --svm-default-gamma scale
```

**å‚æ•°æœç´¢æ€§èƒ½ï¼š**
- æœç´¢è¿‡ç¨‹ä½¿ç”¨**å¹¶è¡Œè®¡ç®—**ï¼ˆé»˜è®¤ `--n-jobs 16`ï¼‰ï¼Œå¯æ˜¾è‘—åŠ é€Ÿæœç´¢
- æ‰€æœ‰å‚æ•°ç»„åˆé€šè¿‡ **5æŠ˜äº¤å‰éªŒè¯è¯„ä¼°**ï¼Œç¡®ä¿ç»“æœç¨³å®šå¯é 
- æœç´¢å®Œæˆåä¼šè‡ªåŠ¨ä¿å­˜æœ€ä½³æ¨¡å‹å’Œæœç´¢ç»“æœåˆ°è¿è¡Œç›®å½•

#### è®­ç»ƒç»“æœ

ä½¿ç”¨ä¸Šæ–‡æå–çš„**æœ€ä½³ç‰¹å¾ç»„åˆ**ï¼ˆå³ color_hist + corner_edge + edge_hist + gabor + glcm + hog + lbp + siftï¼‰è¿›è¡Œè®­ç»ƒ

| æ¨¡å‹ | è®­ç»ƒå‡†ç¡®ç‡ | éªŒè¯å‡†ç¡®ç‡ | æµ‹è¯•å‡†ç¡®ç‡ | äº¤å‰éªŒè¯ |
| ----- | ----- | ----- | ----- | ----- |
| ğŸ¥‡ SVM | 100.00% | **81.50%** | **80.70%** | 5æŠ˜ |
| ğŸ¥ˆ é€»è¾‘å›å½’ | 81.53% | 77.00% | 77.80% | 5æŠ˜ |
| ğŸ¥‰ éšæœºæ£®æ— | 99.88% | 74.80% | 74.30% | 5æŠ˜ |

#### é›†æˆå­¦ä¹ 

```bash
# è½¯æŠ•ç¥¨é›†æˆ
python ensemble.py --method voting --voting soft

# ç¡¬æŠ•ç¥¨é›†æˆ
python ensemble.py --method voting --voting hard

# å †å æ³›åŒ–
python ensemble.py --method stacking

# è‡ªé€‚åº”å¢å¼º
python ensemble.py --method adaboost
```

> âš ï¸ **æ³¨**ï¼šç›®å‰é›†æˆå­¦ä¹ çš„æ•ˆæœæ²¡æœ‰å•ä¸ªSVMæ¨¡å‹çš„å¥½ï¼Œå¾…ä¿®å¤ã€‚

### ğŸ”¥ æ·±åº¦å­¦ä¹ æ–¹æ³•

æ·±åº¦å­¦ä¹ æ¨¡å‹ä½¿ç”¨ç«¯åˆ°ç«¯çš„å­¦ä¹ æ–¹å¼ï¼Œç›´æ¥ä»åŸå§‹å›¾åƒå­¦ä¹ ç‰¹å¾è¡¨ç¤ºï¼Œæ— éœ€æ‰‹å·¥ç‰¹å¾å·¥ç¨‹ã€‚

#### æ•°æ®å¢å¼º

ä¸ºå‡å°‘è¿‡æ‹Ÿåˆï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œé¡¹ç›®é‡‡ç”¨äº†ä»¥ä¸‹æ•°æ®å¢å¼ºæŠ€æœ¯ï¼ˆä»…åœ¨è®­ç»ƒæ—¶ä½¿ç”¨ï¼‰ï¼š

| å¢å¼ºæ–¹æ³• | å‚æ•° | è¯´æ˜ |
| ------ | ------ | ------ |
| **RandomResizedCrop** | scale=(0.9, 1.0), ratio=(0.9, 1.1) | éšæœºè£å‰ªå’Œç¼©æ”¾ï¼Œæé«˜æ³›åŒ–èƒ½åŠ› |
| **RandomHorizontalFlip** | p=0.5 | éšæœºæ°´å¹³ç¿»è½¬ï¼Œå¢åŠ æ•°æ®å¤šæ ·æ€§ |
| **RandomRotation** | degrees=10 | éšæœºæ—‹è½¬ Â±10 åº¦ï¼Œå¢å¼ºé²æ£’æ€§ |
| **ColorJitter** | brightness=0.2, contrast=0.2, saturation=0.2, hue=0.1 | é¢œè‰²æŠ–åŠ¨ï¼Œé€‚åº”ä¸åŒå…‰ç…§æ¡ä»¶ |
| **GaussianBlur** | kernel_size=3, sigma=(0.1, 1.0) | é«˜æ–¯æ¨¡ç³Šï¼Œæ¨¡æ‹Ÿå›¾åƒæ¨¡ç³Š |

éªŒè¯/æµ‹è¯•æ—¶ï¼š
- ä»…ä½¿ç”¨åŸºç¡€å˜æ¢ï¼šResize â†’ ToTensor
- ä¸ä½¿ç”¨ä»»ä½•éšæœºå¢å¼ºï¼Œä¿è¯ç»“æœå¯å¤ç°

#### æ¨¡å‹è®­ç»ƒ

**è®­ç»ƒå‘½ä»¤ï¼š**

```bash
# è®­ç»ƒ CNN-v1
python train_torch.py --arch cnn_v1 --batch-size 512 --epochs 120

# è®­ç»ƒ CNN-v2
python train_torch.py --arch cnn_v2 --batch-size 512 --epochs 120

# è®­ç»ƒ ResNet18
python train_torch.py --arch resnet18 --batch-size 512 --epochs 120

# è®­ç»ƒ ResNet34
python train_torch.py --arch resnet34 --batch-size 512 --epochs 120

# è®­ç»ƒ ResNet50
python train_torch.py --arch resnet50 --batch-size 512 --epochs 120
```

**è‡ªå®šä¹‰è®­ç»ƒå‚æ•°ï¼š**

```bash
# è‡ªå®šä¹‰å­¦ä¹ ç‡å’Œè°ƒåº¦å™¨
python train_torch.py \
    --arch resnet34 \
    --batch-size 256 \
    --epochs 100 \
    --lr 0.0001 \
    --weight-decay 0.0001 \
    --scheduler cosine \
    --early-stop-patience 15

# ä¸ä½¿ç”¨é¢„è®­ç»ƒæƒé‡ï¼ˆä»å¤´è®­ç»ƒï¼‰
python train_torch.py \
    --arch resnet34 \
    --no-resnet-pretrained \
    --batch-size 128 \
    --epochs 200

# è§£å†» backboneï¼ˆå¾®è°ƒæ•´ä¸ªç½‘ç»œï¼‰
python train_torch.py \
    --arch resnet34 \
    --no-freeze-backbone \
    --lr 0.00001 \
    --batch-size 128
```

#### è®­ç»ƒç»“æœ

**è®­ç»ƒé…ç½®ï¼š**
- å›¾åƒå°ºå¯¸ï¼š224Ã—224
- æƒé‡è¡°å‡ï¼š0.0001
- æ—©åœè€å¿ƒå€¼ï¼š10
- æ··åˆç²¾åº¦è®­ç»ƒï¼ˆAMPï¼‰ï¼šâœ…
- å·¥ä½œè¿›ç¨‹æ•°ï¼š16
- ä¼˜åŒ–å™¨ï¼šAdam
- è°ƒåº¦å™¨ï¼šCosine

| æ¨¡å‹ | éªŒè¯å‡†ç¡®ç‡ | æµ‹è¯•å‡†ç¡®ç‡ | æœ€ä½³è½®æ•° | æ‰¹æ¬¡å¤§å° | å­¦ä¹ ç‡ | æ•°æ®å¢å¼º | é¢„è®­ç»ƒæƒé‡ | å†»ç»“backbone |
| -----|  ----- | ----- | -----| ----- | ----- | ----- | ----- | -----|
| ğŸ¥‡ ResNet50 | **99.20%** | **98.40%** | 23 | 512 | 0.001 | âœ… | âœ… | âœ… |
| ğŸ¥ˆ ResNet34 |  **98.60%** | **98.30%** | 29 | 512 | 0.001  | âœ… | âœ… | âœ… |
| ğŸ¥‰ ResNet18 |  **98.10%** | **98.20%** | 13 | 512 | 0.001  | âœ… |âœ… | âœ… |
| CNN-v2 | 91.90% | 93.40% | 40 | 512 | 0.001  | âœ… | âŒ | - |
| CNN-v1 |  91.50% | 92.60% | 79 | 512 | 0.001  | âœ… |âŒ | - |
| CNN-v2 | 89.80% | 91.60% | 53 | 512 | 0.001  | âŒ | âŒ | - |
| CNN-v1 | 86.20% | 87.30% | 63 | 512 | 0.001  | âŒ |âŒ | - |

#### æ¨ç†é¢„æµ‹

**å•å¼ å›¾ç‰‡æ¨ç†ï¼š**

```bash
# åŸºç¡€æ¨ç†
python infer.py \
    --checkpoint runs/torch_resnet34_20251114-105541/best.pt \
    --image path/to/image.jpg

# ä¿å­˜é¢„æµ‹ç»“æœ
python infer.py \
    --checkpoint runs/torch_resnet34_20251114-105541/best.pt \
    --image path/to/image.jpg \
    --output prediction.json
```

**æ‰¹é‡æ¨ç†ï¼š**

```bash
# æ¨ç†æ•´ä¸ªç›®å½•
python infer.py \
    --checkpoint runs/torch_resnet34_20251114-105541/best.pt \
    --image-dir dataset/test/ \
    --output predictions.csv

# å¯¼å‡ºä¸º JSON æ ¼å¼
python infer.py \
    --checkpoint runs/torch_resnet34_20251114-105541/best.pt \
    --image-dir dataset/test/ \
    --output predictions.json \
    --format json
```

**å‚æ•°é€‰é¡¹ï¼š**

- `--checkpoint`: æ¨¡å‹æ£€æŸ¥ç‚¹è·¯å¾„ï¼ˆå¿…éœ€ï¼‰
- `--image`: å•å¼ å›¾ç‰‡è·¯å¾„
- `--image-dir`: å›¾ç‰‡ç›®å½•è·¯å¾„
- `--output`: è¾“å‡ºæ–‡ä»¶è·¯å¾„
- `--format`: è¾“å‡ºæ ¼å¼ï¼ˆcsv/jsonï¼‰
- `--batch-size`: æ‰¹é‡æ¨ç†æ‰¹æ¬¡å¤§å°
- `--device`: æ¨ç†è®¾å¤‡ï¼ˆcuda/cpuï¼‰

## ğŸ¨ å¯è§†åŒ–

### ğŸ“Š è‡ªåŠ¨ç”Ÿæˆçš„å¯è§†åŒ–

é¡¹ç›®åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹å¯è§†åŒ–ç»“æœï¼ˆä¿å­˜åœ¨ `runs/*/figures/` ç›®å½•ï¼‰ï¼š

- **è®­ç»ƒ/éªŒè¯æŸå¤±æ›²çº¿** - ç›‘æ§è®­ç»ƒè¿‡ç¨‹ï¼Œæ£€æµ‹è¿‡æ‹Ÿåˆ
- **è®­ç»ƒ/éªŒè¯å‡†ç¡®ç‡æ›²çº¿** - è¯„ä¼°æ¨¡å‹æ€§èƒ½æå‡
- **æ··æ·†çŸ©é˜µ** - åˆ†æåˆ†ç±»é”™è¯¯æ¨¡å¼
- **ROC æ›²çº¿** - è¯„ä¼°åˆ†ç±»å™¨æ€§èƒ½
- **åˆ†ç±»æŠ¥å‘Š** - è¯¦ç»†çš„æ€§èƒ½æŒ‡æ ‡ï¼ˆç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1ï¼‰

**ç¤ºä¾‹ï¼š**

![SVMå‚æ•°æœç´¢ç»“æœ](./runs/sklearn_svm_20251112-195558/figures/cv_results.png)

![SVMæµ‹è¯•æ··æ·†çŸ©é˜µ](./runs/sklearn_svm_20251112-195558/figures/svm_test_confusion.png)

![SVMæµ‹è¯•ROCæ›²çº¿](./runs/sklearn_svm_20251112-195558/figures/svm_test_roc.png)


### ğŸ“ˆ TensorBoard å¯è§†åŒ–

ä½¿ç”¨ TensorBoard å®æ—¶æŸ¥çœ‹è®­ç»ƒè¿‡ç¨‹ï¼š

```bash
# æŸ¥çœ‹å•ä¸ªå®éªŒ
tensorboard --logdir=runs/torch_resnet34_20251114-105541/events

# å¯¹æ¯”å¤šä¸ªå®éªŒ
tensorboard --logdir=runs/

# æŒ‡å®šç«¯å£
tensorboard --logdir=runs/ --port 6006
```

**ç¤ºä¾‹ï¼š**

![tensorboardç•Œé¢](./img/tensorboard.png)

### ğŸŒ Web ç•Œé¢

**å¯åŠ¨ Gradio ç•Œé¢ï¼š**

```bash
python gradio_run.py --server-port 7860
```

å¯åŠ¨åï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®æ˜¾ç¤ºçš„ URLï¼ˆé€šå¸¸æ˜¯ `http://localhost:7860`ï¼‰å³å¯ä½¿ç”¨ Web ç•Œé¢è¿›è¡Œå›¾åƒåˆ†ç±»ã€‚

**ç¤ºä¾‹ï¼š**

![gradioç•Œé¢](./img/gradio.png)

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡Issueæå‡ºï¼Œä¹Ÿå¯ä»¥å‘é€é‚®ä»¶è‡³ [lxywasd@gmail.com](mailto:lxywasd@gmail.com) ä¸æˆ‘è”ç³»ã€‚

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªStaræ”¯æŒä¸€ä¸‹~ â­**
