2025-11-14 10:27:27 | INFO | 开始训练
2025-11-14 10:27:27 | INFO |   arch: cnn_v2
2025-11-14 10:27:27 | INFO |   data_dir: dataset
2025-11-14 10:27:27 | INFO |   batch_size: 512
2025-11-14 10:27:27 | INFO |   epochs: 120
2025-11-14 10:27:27 | INFO | 启动 CNN-V2 训练流程
2025-11-14 10:27:27 | INFO | 猫狗分类 - CNN v2 训练
2025-11-14 10:27:27 | INFO | 运行环境
2025-11-14 10:27:27 | INFO |   计算设备: CUDA
2025-11-14 10:27:27 | INFO |   GPU型号: NVIDIA GeForce RTX 3090
2025-11-14 10:27:27 | INFO |   GPU内存: 23.7 GB
2025-11-14 10:27:27 | INFO |   混合精度(AMP): 启用
2025-11-14 10:27:27 | INFO | 
正在加载数据集...
2025-11-14 10:27:27 | INFO | 数据集信息
2025-11-14 10:27:27 | INFO |   训练样本数: 8,000 (88.9%)
2025-11-14 10:27:27 | INFO |   验证样本数: 1,000 (11.1%)
2025-11-14 10:27:27 | INFO |   测试样本数: 1,000
2025-11-14 10:27:27 | INFO |   类别数量: 2 (cats, dogs)
2025-11-14 10:27:27 | INFO |   每轮步数: 15
2025-11-14 10:27:27 | INFO | 模型配置
2025-11-14 10:27:27 | INFO |   模型架构: CatDogCNNv2
2025-11-14 10:27:27 | INFO |   参数总量: 266,753
2025-11-14 10:27:27 | INFO |   可训练参数: 266,753
2025-11-14 10:27:27 | INFO |   图像尺寸: 224x224
2025-11-14 10:27:27 | INFO |   Dropout: 0.0
2025-11-14 10:27:27 | INFO |   标准化: 默认[0,1]
2025-11-14 10:27:27 | INFO |   数据增强: 启用
2025-11-14 10:27:27 | INFO | 
计算数据集类别分布...
2025-11-14 10:27:33 | INFO | 训练配置
2025-11-14 10:27:33 | INFO |   训练轮数: 120
2025-11-14 10:27:33 | INFO |   批次大小: 512
2025-11-14 10:27:33 | INFO |   优化器: ADAM
2025-11-14 10:27:33 | INFO |   初始学习率: 0.001
2025-11-14 10:27:33 | INFO |   权重衰减: 0.0001
2025-11-14 10:27:33 | INFO |   学习率调度: cosine
2025-11-14 10:27:33 | INFO |   早停耐心值: 10
2025-11-14 10:27:33 | INFO |   早停评估指标: accuracy
2025-11-14 10:27:33 | INFO |   工作进程数: 16
2025-11-14 10:27:33 | INFO |   类别权重: cats=1.00, dogs=1.01
2025-11-14 10:27:33 | INFO | 
TensorBoard日志目录: runs/torch_cnn-v2_20251114-102727/events
2025-11-14 10:27:33 | INFO | 模型保存目录: runs/torch_cnn-v2_20251114-102727
2025-11-14 10:27:33 | INFO | 训练日志: runs/torch_cnn-v2_20251114-102727/cnn_v2.log
2025-11-14 10:27:34 | INFO | 开始训练
2025-11-14 10:27:47 | INFO | Epoch   1/120 | 耗时: 13秒 | ETA: 26.7分钟
2025-11-14 10:27:47 | INFO |    训练 - Loss: 0.6613 | Acc: 60.07% | Prec: 0.606 | Rec: 0.581 | F1: 0.593
2025-11-14 10:27:47 | INFO |    验证 - Loss: 0.7454 | Acc: 50.00% | Prec: 0.000 | Rec: 0.000 | F1: 0.000 [最佳]
2025-11-14 10:27:47 | INFO |    学习率: 0.001000 -> 0.001000
2025-11-14 10:27:58 | INFO | Epoch   2/120 | 耗时: 10秒 | ETA: 23.7分钟
2025-11-14 10:27:58 | INFO |    训练 - Loss: 0.6287 | Acc: 64.44% | Prec: 0.646 | Rec: 0.635 | F1: 0.640
2025-11-14 10:27:58 | INFO |    验证 - Loss: 0.8835 | Acc: 50.00% | Prec: 0.000 | Rec: 0.000 | F1: 0.000 
2025-11-14 10:27:58 | INFO |    学习率: 0.001000 -> 0.000999
2025-11-14 10:28:09 | INFO | Epoch   3/120 | 耗时: 11秒 | ETA: 23.2分钟
2025-11-14 10:28:09 | INFO |    训练 - Loss: 0.6008 | Acc: 67.55% | Prec: 0.684 | Rec: 0.653 | F1: 0.668
2025-11-14 10:28:09 | INFO |    验证 - Loss: 0.9727 | Acc: 50.20% | Prec: 1.000 | Rec: 0.004 | F1: 0.008 [最佳]
2025-11-14 10:28:09 | INFO |    学习率: 0.000999 -> 0.000998
2025-11-14 10:28:21 | INFO | Epoch   4/120 | 耗时: 11秒 | ETA: 22.7分钟
2025-11-14 10:28:21 | INFO |    训练 - Loss: 0.5730 | Acc: 70.87% | Prec: 0.723 | Rec: 0.676 | F1: 0.699
2025-11-14 10:28:21 | INFO |    验证 - Loss: 0.7525 | Acc: 57.10% | Prec: 0.882 | Rec: 0.164 | F1: 0.277 [最佳]
2025-11-14 10:28:21 | INFO |    学习率: 0.000998 -> 0.000997
2025-11-14 10:28:31 | INFO | Epoch   5/120 | 耗时: 10秒 | ETA: 22.1分钟
2025-11-14 10:28:31 | INFO |    训练 - Loss: 0.5494 | Acc: 72.51% | Prec: 0.728 | Rec: 0.719 | F1: 0.723
2025-11-14 10:28:31 | INFO |    验证 - Loss: 0.5511 | Acc: 73.30% | Prec: 0.775 | Rec: 0.656 | F1: 0.711 [最佳]
2025-11-14 10:28:31 | INFO |    学习率: 0.000997 -> 0.000996
2025-11-14 10:28:42 | INFO | Epoch   6/120 | 耗时: 10秒 | ETA: 21.7分钟
2025-11-14 10:28:42 | INFO |    训练 - Loss: 0.5264 | Acc: 74.32% | Prec: 0.757 | Rec: 0.718 | F1: 0.737
2025-11-14 10:28:42 | INFO |    验证 - Loss: 0.5469 | Acc: 71.70% | Prec: 0.752 | Rec: 0.648 | F1: 0.696 
2025-11-14 10:28:42 | INFO |    学习率: 0.000996 -> 0.000994
2025-11-14 10:28:53 | INFO | Epoch   7/120 | 耗时: 10秒 | ETA: 21.3分钟
2025-11-14 10:28:53 | INFO |    训练 - Loss: 0.5140 | Acc: 74.75% | Prec: 0.753 | Rec: 0.738 | F1: 0.746
2025-11-14 10:28:53 | INFO |    验证 - Loss: 0.7613 | Acc: 63.70% | Prec: 0.887 | Rec: 0.314 | F1: 0.464 
2025-11-14 10:28:53 | INFO |    学习率: 0.000994 -> 0.000992
2025-11-14 10:29:03 | INFO | Epoch   8/120 | 耗时: 10秒 | ETA: 20.9分钟
2025-11-14 10:29:03 | INFO |    训练 - Loss: 0.5023 | Acc: 75.34% | Prec: 0.768 | Rec: 0.727 | F1: 0.747
2025-11-14 10:29:03 | INFO |    验证 - Loss: 0.5245 | Acc: 73.80% | Prec: 0.725 | Rec: 0.766 | F1: 0.745 [最佳]
2025-11-14 10:29:03 | INFO |    学习率: 0.000992 -> 0.000989
2025-11-14 10:29:14 | INFO | Epoch   9/120 | 耗时: 10秒 | ETA: 20.7分钟
2025-11-14 10:29:14 | INFO |    训练 - Loss: 0.4817 | Acc: 76.85% | Prec: 0.769 | Rec: 0.768 | F1: 0.769
2025-11-14 10:29:14 | INFO |    验证 - Loss: 0.5527 | Acc: 72.10% | Prec: 0.679 | Rec: 0.838 | F1: 0.750 
2025-11-14 10:29:14 | INFO |    学习率: 0.000989 -> 0.000986
2025-11-14 10:29:27 | INFO | Epoch  10/120 | 耗时: 12秒 | ETA: 20.7分钟
2025-11-14 10:29:27 | INFO |    训练 - Loss: 0.4643 | Acc: 77.96% | Prec: 0.785 | Rec: 0.770 | F1: 0.778
2025-11-14 10:29:27 | INFO |    验证 - Loss: 0.7015 | Acc: 68.10% | Prec: 0.627 | Rec: 0.896 | F1: 0.737 
2025-11-14 10:29:27 | INFO |    学习率: 0.000986 -> 0.000983
2025-11-14 10:29:37 | INFO | Epoch  11/120 | 耗时: 10秒 | ETA: 20.4分钟
2025-11-14 10:29:37 | INFO |    训练 - Loss: 0.4502 | Acc: 79.31% | Prec: 0.798 | Rec: 0.785 | F1: 0.791
2025-11-14 10:29:37 | INFO |    验证 - Loss: 0.5864 | Acc: 74.30% | Prec: 0.725 | Rec: 0.784 | F1: 0.753 [最佳]
2025-11-14 10:29:37 | INFO |    学习率: 0.000983 -> 0.000979
2025-11-14 10:29:48 | INFO | Epoch  12/120 | 耗时: 11秒 | ETA: 20.2分钟
2025-11-14 10:29:48 | INFO |    训练 - Loss: 0.4354 | Acc: 79.79% | Prec: 0.808 | Rec: 0.780 | F1: 0.794
2025-11-14 10:29:48 | INFO |    验证 - Loss: 0.8553 | Acc: 67.80% | Prec: 0.905 | Rec: 0.398 | F1: 0.553 
2025-11-14 10:29:48 | INFO |    学习率: 0.000979 -> 0.000976
2025-11-14 10:29:59 | INFO | Epoch  13/120 | 耗时: 10秒 | ETA: 20.0分钟
2025-11-14 10:29:59 | INFO |    训练 - Loss: 0.4072 | Acc: 81.45% | Prec: 0.819 | Rec: 0.809 | F1: 0.814
2025-11-14 10:29:59 | INFO |    验证 - Loss: 0.5462 | Acc: 75.10% | Prec: 0.690 | Rec: 0.912 | F1: 0.786 [最佳]
2025-11-14 10:29:59 | INFO |    学习率: 0.000976 -> 0.000971
2025-11-14 10:30:10 | INFO | Epoch  14/120 | 耗时: 10秒 | ETA: 19.7分钟
2025-11-14 10:30:10 | INFO |    训练 - Loss: 0.3948 | Acc: 82.62% | Prec: 0.830 | Rec: 0.821 | F1: 0.825
2025-11-14 10:30:10 | INFO |    验证 - Loss: 0.5872 | Acc: 72.90% | Prec: 0.907 | Rec: 0.510 | F1: 0.653 
2025-11-14 10:30:10 | INFO |    学习率: 0.000971 -> 0.000967
2025-11-14 10:30:21 | INFO | Epoch  15/120 | 耗时: 10秒 | ETA: 19.5分钟
2025-11-14 10:30:21 | INFO |    训练 - Loss: 0.3761 | Acc: 82.94% | Prec: 0.829 | Rec: 0.828 | F1: 0.829
2025-11-14 10:30:21 | INFO |    验证 - Loss: 0.5951 | Acc: 73.40% | Prec: 0.661 | Rec: 0.962 | F1: 0.783 
2025-11-14 10:30:21 | INFO |    学习率: 0.000967 -> 0.000962
2025-11-14 10:30:31 | INFO | Epoch  16/120 | 耗时: 10秒 | ETA: 19.3分钟
2025-11-14 10:30:31 | INFO |    训练 - Loss: 0.3547 | Acc: 84.17% | Prec: 0.844 | Rec: 0.837 | F1: 0.841
2025-11-14 10:30:31 | INFO |    验证 - Loss: 1.0572 | Acc: 64.40% | Prec: 0.944 | Rec: 0.306 | F1: 0.462 
2025-11-14 10:30:31 | INFO |    学习率: 0.000962 -> 0.000957
2025-11-14 10:30:42 | INFO | Epoch  17/120 | 耗时: 10秒 | ETA: 19.0分钟
2025-11-14 10:30:42 | INFO |    训练 - Loss: 0.3228 | Acc: 86.08% | Prec: 0.866 | Rec: 0.854 | F1: 0.860
2025-11-14 10:30:42 | INFO |    验证 - Loss: 0.7142 | Acc: 72.00% | Prec: 0.644 | Rec: 0.984 | F1: 0.778 
2025-11-14 10:30:42 | INFO |    学习率: 0.000957 -> 0.000951
2025-11-14 10:30:53 | INFO | Epoch  18/120 | 耗时: 10秒 | ETA: 18.8分钟
2025-11-14 10:30:53 | INFO |    训练 - Loss: 0.2953 | Acc: 87.58% | Prec: 0.876 | Rec: 0.876 | F1: 0.876
2025-11-14 10:30:53 | INFO |    验证 - Loss: 0.9538 | Acc: 61.40% | Prec: 0.564 | Rec: 0.998 | F1: 0.721 
2025-11-14 10:30:53 | INFO |    学习率: 0.000951 -> 0.000946
2025-11-14 10:31:03 | INFO | Epoch  19/120 | 耗时: 10秒 | ETA: 18.6分钟
2025-11-14 10:31:03 | INFO |    训练 - Loss: 0.2859 | Acc: 87.86% | Prec: 0.883 | Rec: 0.873 | F1: 0.878
2025-11-14 10:31:03 | INFO |    验证 - Loss: 1.1335 | Acc: 66.40% | Prec: 0.906 | Rec: 0.366 | F1: 0.521 
2025-11-14 10:31:03 | INFO |    学习率: 0.000946 -> 0.000939
2025-11-14 10:31:16 | INFO | Epoch  20/120 | 耗时: 12秒 | ETA: 18.5分钟
2025-11-14 10:31:16 | INFO |    训练 - Loss: 0.2655 | Acc: 89.17% | Prec: 0.894 | Rec: 0.887 | F1: 0.891
2025-11-14 10:31:16 | INFO |    验证 - Loss: 0.3390 | Acc: 85.30% | Prec: 0.810 | Rec: 0.922 | F1: 0.862 [最佳]
2025-11-14 10:31:16 | INFO |    学习率: 0.000939 -> 0.000933
2025-11-14 10:31:27 | INFO | Epoch  21/120 | 耗时: 11秒 | ETA: 18.3分钟
2025-11-14 10:31:27 | INFO |    训练 - Loss: 0.2489 | Acc: 89.95% | Prec: 0.901 | Rec: 0.897 | F1: 0.899
2025-11-14 10:31:27 | INFO |    验证 - Loss: 0.6833 | Acc: 72.90% | Prec: 0.949 | Rec: 0.484 | F1: 0.641 
2025-11-14 10:31:27 | INFO |    学习率: 0.000933 -> 0.000926
2025-11-14 10:31:38 | INFO | Epoch  22/120 | 耗时: 10秒 | ETA: 18.1分钟
2025-11-14 10:31:38 | INFO |    训练 - Loss: 0.2367 | Acc: 90.03% | Prec: 0.898 | Rec: 0.904 | F1: 0.901
2025-11-14 10:31:38 | INFO |    验证 - Loss: 0.3859 | Acc: 84.30% | Prec: 0.783 | Rec: 0.948 | F1: 0.858 
2025-11-14 10:31:38 | INFO |    学习率: 0.000926 -> 0.000919
2025-11-14 10:31:49 | INFO | Epoch  23/120 | 耗时: 10秒 | ETA: 17.9分钟
2025-11-14 10:31:49 | INFO |    训练 - Loss: 0.2188 | Acc: 91.11% | Prec: 0.915 | Rec: 0.907 | F1: 0.911
2025-11-14 10:31:49 | INFO |    验证 - Loss: 0.2958 | Acc: 87.00% | Prec: 0.902 | Rec: 0.830 | F1: 0.865 [最佳]
2025-11-14 10:31:49 | INFO |    学习率: 0.000919 -> 0.000912
2025-11-14 10:31:59 | INFO | Epoch  24/120 | 耗时: 10秒 | ETA: 17.7分钟
2025-11-14 10:31:59 | INFO |    训练 - Loss: 0.2118 | Acc: 91.58% | Prec: 0.922 | Rec: 0.909 | F1: 0.915
2025-11-14 10:31:59 | INFO |    验证 - Loss: 0.2800 | Acc: 88.50% | Prec: 0.844 | Rec: 0.944 | F1: 0.891 [最佳]
2025-11-14 10:31:59 | INFO |    学习率: 0.000912 -> 0.000905
2025-11-14 10:32:11 | INFO | Epoch  25/120 | 耗时: 11秒 | ETA: 17.5分钟
2025-11-14 10:32:11 | INFO |    训练 - Loss: 0.1911 | Acc: 92.34% | Prec: 0.920 | Rec: 0.928 | F1: 0.924
2025-11-14 10:32:11 | INFO |    验证 - Loss: 0.5236 | Acc: 77.10% | Prec: 0.956 | Rec: 0.568 | F1: 0.713 
2025-11-14 10:32:11 | INFO |    学习率: 0.000905 -> 0.000897
2025-11-14 10:32:21 | INFO | Epoch  26/120 | 耗时: 10秒 | ETA: 17.3分钟
2025-11-14 10:32:21 | INFO |    训练 - Loss: 0.1898 | Acc: 92.41% | Prec: 0.925 | Rec: 0.923 | F1: 0.924
2025-11-14 10:32:21 | INFO |    验证 - Loss: 0.3973 | Acc: 81.80% | Prec: 0.944 | Rec: 0.676 | F1: 0.788 
2025-11-14 10:32:21 | INFO |    学习率: 0.000897 -> 0.000889
2025-11-14 10:32:32 | INFO | Epoch  27/120 | 耗时: 10秒 | ETA: 17.1分钟
2025-11-14 10:32:32 | INFO |    训练 - Loss: 0.1745 | Acc: 93.20% | Prec: 0.935 | Rec: 0.928 | F1: 0.932
2025-11-14 10:32:32 | INFO |    验证 - Loss: 0.7530 | Acc: 77.50% | Prec: 0.960 | Rec: 0.574 | F1: 0.718 
2025-11-14 10:32:32 | INFO |    学习率: 0.000889 -> 0.000880
2025-11-14 10:32:42 | INFO | Epoch  28/120 | 耗时: 10秒 | ETA: 16.9分钟
2025-11-14 10:32:42 | INFO |    训练 - Loss: 0.1733 | Acc: 93.12% | Prec: 0.934 | Rec: 0.928 | F1: 0.931
2025-11-14 10:32:42 | INFO |    验证 - Loss: 0.3132 | Acc: 86.00% | Prec: 0.907 | Rec: 0.802 | F1: 0.851 
2025-11-14 10:32:42 | INFO |    学习率: 0.000880 -> 0.000872
2025-11-14 10:32:54 | INFO | Epoch  29/120 | 耗时: 11秒 | ETA: 16.7分钟
2025-11-14 10:32:54 | INFO |    训练 - Loss: 0.1619 | Acc: 93.37% | Prec: 0.933 | Rec: 0.934 | F1: 0.934
2025-11-14 10:32:54 | INFO |    验证 - Loss: 0.4463 | Acc: 84.00% | Prec: 0.763 | Rec: 0.986 | F1: 0.860 
2025-11-14 10:32:54 | INFO |    学习率: 0.000872 -> 0.000863
2025-11-14 10:33:07 | INFO | Epoch  30/120 | 耗时: 13秒 | ETA: 16.6分钟
2025-11-14 10:33:07 | INFO |    训练 - Loss: 0.1643 | Acc: 93.68% | Prec: 0.939 | Rec: 0.935 | F1: 0.937
2025-11-14 10:33:07 | INFO |    验证 - Loss: 0.3254 | Acc: 87.40% | Prec: 0.821 | Rec: 0.956 | F1: 0.884 
2025-11-14 10:33:07 | INFO |    学习率: 0.000863 -> 0.000854
2025-11-14 10:33:17 | INFO | Epoch  31/120 | 耗时: 10秒 | ETA: 16.4分钟
2025-11-14 10:33:17 | INFO |    训练 - Loss: 0.1474 | Acc: 94.19% | Prec: 0.943 | Rec: 0.941 | F1: 0.942
2025-11-14 10:33:17 | INFO |    验证 - Loss: 0.3011 | Acc: 89.30% | Prec: 0.857 | Rec: 0.944 | F1: 0.898 [最佳]
2025-11-14 10:33:17 | INFO |    学习率: 0.000854 -> 0.000844
2025-11-14 10:33:29 | INFO | Epoch  32/120 | 耗时: 11秒 | ETA: 16.3分钟
2025-11-14 10:33:29 | INFO |    训练 - Loss: 0.1449 | Acc: 94.22% | Prec: 0.941 | Rec: 0.943 | F1: 0.942
2025-11-14 10:33:29 | INFO |    验证 - Loss: 0.2595 | Acc: 90.20% | Prec: 0.881 | Rec: 0.930 | F1: 0.905 [最佳]
2025-11-14 10:33:29 | INFO |    学习率: 0.000844 -> 0.000835
2025-11-14 10:33:39 | INFO | Epoch  33/120 | 耗时: 10秒 | ETA: 16.1分钟
2025-11-14 10:33:39 | INFO |    训练 - Loss: 0.1343 | Acc: 94.79% | Prec: 0.948 | Rec: 0.948 | F1: 0.948
2025-11-14 10:33:39 | INFO |    验证 - Loss: 0.2304 | Acc: 91.20% | Prec: 0.920 | Rec: 0.902 | F1: 0.911 [最佳]
2025-11-14 10:33:39 | INFO |    学习率: 0.000835 -> 0.000825
2025-11-14 10:33:51 | INFO | Epoch  34/120 | 耗时: 11秒 | ETA: 15.9分钟
2025-11-14 10:33:51 | INFO |    训练 - Loss: 0.1354 | Acc: 94.39% | Prec: 0.943 | Rec: 0.945 | F1: 0.944
2025-11-14 10:33:51 | INFO |    验证 - Loss: 0.4445 | Acc: 84.10% | Prec: 0.765 | Rec: 0.984 | F1: 0.861 
2025-11-14 10:33:51 | INFO |    学习率: 0.000825 -> 0.000815
2025-11-14 10:34:02 | INFO | Epoch  35/120 | 耗时: 10秒 | ETA: 15.7分钟
2025-11-14 10:34:02 | INFO |    训练 - Loss: 0.1313 | Acc: 95.07% | Prec: 0.949 | Rec: 0.952 | F1: 0.951
2025-11-14 10:34:02 | INFO |    验证 - Loss: 0.2977 | Acc: 88.30% | Prec: 0.823 | Rec: 0.976 | F1: 0.893 
2025-11-14 10:34:02 | INFO |    学习率: 0.000815 -> 0.000804
2025-11-14 10:34:12 | INFO | Epoch  36/120 | 耗时: 10秒 | ETA: 15.5分钟
2025-11-14 10:34:12 | INFO |    训练 - Loss: 0.1213 | Acc: 95.23% | Prec: 0.952 | Rec: 0.952 | F1: 0.952
2025-11-14 10:34:12 | INFO |    验证 - Loss: 0.3022 | Acc: 89.40% | Prec: 0.857 | Rec: 0.946 | F1: 0.899 
2025-11-14 10:34:12 | INFO |    学习率: 0.000804 -> 0.000794
2025-11-14 10:34:23 | INFO | Epoch  37/120 | 耗时: 10秒 | ETA: 15.3分钟
2025-11-14 10:34:23 | INFO |    训练 - Loss: 0.1233 | Acc: 95.16% | Prec: 0.954 | Rec: 0.949 | F1: 0.952
2025-11-14 10:34:23 | INFO |    验证 - Loss: 0.2504 | Acc: 89.30% | Prec: 0.848 | Rec: 0.958 | F1: 0.900 
2025-11-14 10:34:23 | INFO |    学习率: 0.000794 -> 0.000783
2025-11-14 10:34:34 | INFO | Epoch  38/120 | 耗时: 10秒 | ETA: 15.1分钟
2025-11-14 10:34:34 | INFO |    训练 - Loss: 0.1115 | Acc: 95.85% | Prec: 0.956 | Rec: 0.961 | F1: 0.959
2025-11-14 10:34:34 | INFO |    验证 - Loss: 0.3675 | Acc: 86.60% | Prec: 0.796 | Rec: 0.984 | F1: 0.880 
2025-11-14 10:34:34 | INFO |    学习率: 0.000783 -> 0.000772
2025-11-14 10:34:45 | INFO | Epoch  39/120 | 耗时: 11秒 | ETA: 14.9分钟
2025-11-14 10:34:45 | INFO |    训练 - Loss: 0.1129 | Acc: 95.91% | Prec: 0.957 | Rec: 0.962 | F1: 0.959
2025-11-14 10:34:45 | INFO |    验证 - Loss: 0.2634 | Acc: 89.60% | Prec: 0.849 | Rec: 0.964 | F1: 0.903 
2025-11-14 10:34:45 | INFO |    学习率: 0.000772 -> 0.000761
2025-11-14 10:34:57 | INFO | Epoch  40/120 | 耗时: 12秒 | ETA: 14.8分钟
2025-11-14 10:34:57 | INFO |    训练 - Loss: 0.1098 | Acc: 95.81% | Prec: 0.958 | Rec: 0.958 | F1: 0.958
2025-11-14 10:34:57 | INFO |    验证 - Loss: 0.2137 | Acc: 91.90% | Prec: 0.934 | Rec: 0.902 | F1: 0.918 [最佳]
2025-11-14 10:34:57 | INFO |    学习率: 0.000761 -> 0.000750
2025-11-14 10:35:08 | INFO | Epoch  41/120 | 耗时: 10秒 | ETA: 14.6分钟
2025-11-14 10:35:08 | INFO |    训练 - Loss: 0.1005 | Acc: 96.37% | Prec: 0.966 | Rec: 0.961 | F1: 0.964
2025-11-14 10:35:08 | INFO |    验证 - Loss: 0.2865 | Acc: 89.20% | Prec: 0.834 | Rec: 0.978 | F1: 0.901 
2025-11-14 10:35:08 | INFO |    学习率: 0.000750 -> 0.000739
2025-11-14 10:35:18 | INFO | Epoch  42/120 | 耗时: 10秒 | ETA: 14.4分钟
2025-11-14 10:35:18 | INFO |    训练 - Loss: 0.0940 | Acc: 96.51% | Prec: 0.965 | Rec: 0.966 | F1: 0.965
2025-11-14 10:35:18 | INFO |    验证 - Loss: 0.2608 | Acc: 90.50% | Prec: 0.892 | Rec: 0.922 | F1: 0.907 
2025-11-14 10:35:18 | INFO |    学习率: 0.000739 -> 0.000727
2025-11-14 10:35:29 | INFO | Epoch  43/120 | 耗时: 10秒 | ETA: 14.2分钟
2025-11-14 10:35:29 | INFO |    训练 - Loss: 0.0904 | Acc: 96.63% | Prec: 0.968 | Rec: 0.965 | F1: 0.966
2025-11-14 10:35:29 | INFO |    验证 - Loss: 0.2374 | Acc: 91.40% | Prec: 0.870 | Rec: 0.974 | F1: 0.919 
2025-11-14 10:35:29 | INFO |    学习率: 0.000727 -> 0.000715
2025-11-14 10:35:40 | INFO | Epoch  44/120 | 耗时: 11秒 | ETA: 14.0分钟
2025-11-14 10:35:40 | INFO |    训练 - Loss: 0.0856 | Acc: 96.90% | Prec: 0.967 | Rec: 0.972 | F1: 0.969
2025-11-14 10:35:40 | INFO |    验证 - Loss: 0.4269 | Acc: 86.00% | Prec: 0.786 | Rec: 0.990 | F1: 0.876 
2025-11-14 10:35:40 | INFO |    学习率: 0.000715 -> 0.000703
2025-11-14 10:35:51 | INFO | Epoch  45/120 | 耗时: 10秒 | ETA: 13.8分钟
2025-11-14 10:35:51 | INFO |    训练 - Loss: 0.0844 | Acc: 96.84% | Prec: 0.970 | Rec: 0.967 | F1: 0.968
2025-11-14 10:35:51 | INFO |    验证 - Loss: 0.5450 | Acc: 81.40% | Prec: 0.973 | Rec: 0.646 | F1: 0.776 
2025-11-14 10:35:51 | INFO |    学习率: 0.000703 -> 0.000691
2025-11-14 10:36:02 | INFO | Epoch  46/120 | 耗时: 11秒 | ETA: 13.6分钟
2025-11-14 10:36:02 | INFO |    训练 - Loss: 0.0831 | Acc: 96.94% | Prec: 0.968 | Rec: 0.971 | F1: 0.970
2025-11-14 10:36:02 | INFO |    验证 - Loss: 0.2868 | Acc: 89.10% | Prec: 0.838 | Rec: 0.970 | F1: 0.899 
2025-11-14 10:36:02 | INFO |    学习率: 0.000691 -> 0.000679
2025-11-14 10:36:13 | INFO | Epoch  47/120 | 耗时: 10秒 | ETA: 13.4分钟
2025-11-14 10:36:13 | INFO |    训练 - Loss: 0.0822 | Acc: 96.93% | Prec: 0.969 | Rec: 0.970 | F1: 0.969
2025-11-14 10:36:13 | INFO |    验证 - Loss: 0.4740 | Acc: 85.30% | Prec: 0.775 | Rec: 0.994 | F1: 0.871 
2025-11-14 10:36:13 | INFO |    学习率: 0.000679 -> 0.000667
2025-11-14 10:36:24 | INFO | Epoch  48/120 | 耗时: 10秒 | ETA: 13.2分钟
2025-11-14 10:36:24 | INFO |    训练 - Loss: 0.0762 | Acc: 97.33% | Prec: 0.976 | Rec: 0.970 | F1: 0.973
2025-11-14 10:36:24 | INFO |    验证 - Loss: 0.2680 | Acc: 90.30% | Prec: 0.872 | Rec: 0.944 | F1: 0.907 
2025-11-14 10:36:24 | INFO |    学习率: 0.000667 -> 0.000655
2025-11-14 10:36:35 | INFO | Epoch  49/120 | 耗时: 11秒 | ETA: 13.1分钟
2025-11-14 10:36:35 | INFO |    训练 - Loss: 0.0706 | Acc: 97.55% | Prec: 0.975 | Rec: 0.976 | F1: 0.976
2025-11-14 10:36:35 | INFO |    验证 - Loss: 0.2218 | Acc: 91.40% | Prec: 0.931 | Rec: 0.894 | F1: 0.912 
2025-11-14 10:36:35 | INFO |    学习率: 0.000655 -> 0.000642
2025-11-14 10:36:47 | INFO | Epoch  50/120 | 耗时: 12秒 | ETA: 12.9分钟
2025-11-14 10:36:47 | INFO |    训练 - Loss: 0.0747 | Acc: 97.25% | Prec: 0.972 | Rec: 0.973 | F1: 0.973
2025-11-14 10:36:47 | INFO |    验证 - Loss: 0.3614 | Acc: 88.80% | Prec: 0.836 | Rec: 0.966 | F1: 0.896 
2025-11-14 10:36:47 | INFO |    学习率: 0.000642 -> 0.000629
2025-11-14 10:36:47 | INFO | 
触发早停 (连续 10 轮 accuracy 无改善)
2025-11-14 10:36:47 | INFO | 训练完成
2025-11-14 10:36:47 | INFO | 训练总结
2025-11-14 10:36:47 | INFO |   总耗时: 9.2分钟
2025-11-14 10:36:47 | INFO |   平均每轮: 11秒
2025-11-14 10:36:47 | INFO |   完成轮数: 50/120
2025-11-14 10:36:47 | INFO |   最佳验证: Epoch 40 - ACCURACY: 0.9190, Loss: 0.2137, Acc: 91.90%
2025-11-14 10:36:47 | INFO | 
正在测试集上评估最佳模型...
2025-11-14 10:36:47 | INFO |    已加载最佳模型 (Epoch 40)
2025-11-14 10:36:49 | INFO | 测试结果
2025-11-14 10:36:49 | INFO |   测试样本数: 1,000
2025-11-14 10:36:49 | INFO |   测试损失: 0.1805
2025-11-14 10:36:49 | INFO |   测试准确率: 93.40%
2025-11-14 10:36:49 | INFO |   测试精确率: 0.941
2025-11-14 10:36:49 | INFO |   测试召回率: 0.926
2025-11-14 10:36:49 | INFO |   测试F1: 0.933
2025-11-14 10:36:49 | INFO | 
正在生成训练曲线可视化...
2025-11-14 10:36:50 | INFO |    训练曲线已保存到: runs/torch_cnn-v2_20251114-102727/figures
2025-11-14 10:36:50 | INFO | 
所有任务完成!
2025-11-14 10:36:50 | INFO |    最佳模型: runs/torch_cnn-v2_20251114-102727/best.pt
2025-11-14 10:36:50 | INFO |    最后模型: runs/torch_cnn-v2_20251114-102727/last.pt
2025-11-14 10:36:50 | INFO |    TensorBoard: tensorboard --logdir=runs/torch_cnn-v2_20251114-102727/events

2025-11-14 10:36:50 | INFO | 训练完成
2025-11-14 10:36:50 | INFO |   耗时: 9.4分钟
2025-11-14 10:36:50 | INFO |   最佳准确率: 0.9190
2025-11-14 10:36:50 | INFO |   运行目录: runs/torch_cnn-v2_20251114-102727
2025-11-14 10:36:50 | INFO | CNN-V2 训练流程完成
