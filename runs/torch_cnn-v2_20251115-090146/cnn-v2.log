2025-11-15 09:01:46 | INFO | 开始训练
2025-11-15 09:01:46 | INFO |   arch: cnn_v2
2025-11-15 09:01:46 | INFO |   data_dir: dataset
2025-11-15 09:01:46 | INFO |   batch_size: 512
2025-11-15 09:01:46 | INFO |   epochs: 120
2025-11-15 09:01:46 | INFO | 启动 CNN-V2 训练流程
2025-11-15 09:01:46 | INFO | 猫狗分类 - CNN v2 训练
2025-11-15 09:01:46 | INFO | 运行环境
2025-11-15 09:01:46 | INFO |   计算设备: CUDA
2025-11-15 09:01:46 | INFO |   GPU型号: NVIDIA GeForce RTX 3090
2025-11-15 09:01:46 | INFO |   GPU内存: 23.7 GB
2025-11-15 09:01:46 | INFO |   混合精度(AMP): 启用
2025-11-15 09:01:46 | INFO | 
正在加载数据集...
2025-11-15 09:01:46 | INFO | 数据集信息
2025-11-15 09:01:46 | INFO |   训练样本数: 8,000 (88.9%)
2025-11-15 09:01:46 | INFO |   验证样本数: 1,000 (11.1%)
2025-11-15 09:01:46 | INFO |   测试样本数: 1,000
2025-11-15 09:01:46 | INFO |   类别数量: 2 (cats, dogs)
2025-11-15 09:01:46 | INFO |   每轮步数: 15
2025-11-15 09:01:46 | INFO | 模型配置
2025-11-15 09:01:46 | INFO |   模型架构: CatDogCNNv2
2025-11-15 09:01:46 | INFO |   参数总量: 266,753
2025-11-15 09:01:46 | INFO |   可训练参数: 266,753
2025-11-15 09:01:46 | INFO |   图像尺寸: 224x224
2025-11-15 09:01:46 | INFO |   Dropout: 0.0
2025-11-15 09:01:46 | INFO |   标准化: 默认[0,1]
2025-11-15 09:01:46 | INFO |   数据增强: 禁用
2025-11-15 09:01:46 | INFO | 
计算数据集类别分布...
2025-11-15 09:01:49 | INFO | 训练配置
2025-11-15 09:01:49 | INFO |   训练轮数: 120
2025-11-15 09:01:49 | INFO |   批次大小: 512
2025-11-15 09:01:49 | INFO |   优化器: ADAM
2025-11-15 09:01:49 | INFO |   初始学习率: 0.001
2025-11-15 09:01:49 | INFO |   权重衰减: 0.0001
2025-11-15 09:01:49 | INFO |   学习率调度: cosine
2025-11-15 09:01:49 | INFO |   早停耐心值: 10
2025-11-15 09:01:49 | INFO |   早停评估指标: accuracy
2025-11-15 09:01:49 | INFO |   工作进程数: 16
2025-11-15 09:01:49 | INFO |   类别权重: cats=1.00, dogs=1.01
2025-11-15 09:01:49 | INFO | 
TensorBoard日志目录: runs/torch_cnn-v2_20251115-090146/events
2025-11-15 09:01:49 | INFO | 模型保存目录: runs/torch_cnn-v2_20251115-090146
2025-11-15 09:01:49 | INFO | 训练日志: runs/torch_cnn-v2_20251115-090146/cnn_v2.log
2025-11-15 09:01:50 | INFO | 开始训练
2025-11-15 09:01:59 | INFO | Epoch   1/120 | 耗时: 8秒 | ETA: 17.1分钟
2025-11-15 09:01:59 | INFO |    训练 - Loss: 0.6422 | Acc: 62.03% | Prec: 0.634 | Rec: 0.574 | F1: 0.602
2025-11-15 09:01:59 | INFO |    验证 - Loss: 0.8233 | Acc: 50.00% | Prec: 0.000 | Rec: 0.000 | F1: 0.000 [最佳]
2025-11-15 09:01:59 | INFO |    学习率: 0.001000 -> 0.001000
2025-11-15 09:02:06 | INFO | Epoch   2/120 | 耗时: 7秒 | ETA: 15.5分钟
2025-11-15 09:02:06 | INFO |    训练 - Loss: 0.5991 | Acc: 67.64% | Prec: 0.687 | Rec: 0.646 | F1: 0.666
2025-11-15 09:02:06 | INFO |    验证 - Loss: 1.0222 | Acc: 50.00% | Prec: 0.000 | Rec: 0.000 | F1: 0.000 
2025-11-15 09:02:06 | INFO |    学习率: 0.001000 -> 0.000999
2025-11-15 09:02:13 | INFO | Epoch   3/120 | 耗时: 7秒 | ETA: 14.8分钟
2025-11-15 09:02:13 | INFO |    训练 - Loss: 0.5590 | Acc: 71.12% | Prec: 0.733 | Rec: 0.665 | F1: 0.697
2025-11-15 09:02:13 | INFO |    验证 - Loss: 1.1440 | Acc: 50.30% | Prec: 1.000 | Rec: 0.006 | F1: 0.012 [最佳]
2025-11-15 09:02:13 | INFO |    学习率: 0.000999 -> 0.000998
2025-11-15 09:02:20 | INFO | Epoch   4/120 | 耗时: 7秒 | ETA: 14.4分钟
2025-11-15 09:02:20 | INFO |    训练 - Loss: 0.5325 | Acc: 73.55% | Prec: 0.749 | Rec: 0.707 | F1: 0.727
2025-11-15 09:02:20 | INFO |    验证 - Loss: 0.9728 | Acc: 52.70% | Prec: 0.935 | Rec: 0.058 | F1: 0.109 [最佳]
2025-11-15 09:02:20 | INFO |    学习率: 0.000998 -> 0.000997
2025-11-15 09:02:27 | INFO | Epoch   5/120 | 耗时: 6秒 | ETA: 14.1分钟
2025-11-15 09:02:27 | INFO |    训练 - Loss: 0.5174 | Acc: 74.87% | Prec: 0.759 | Rec: 0.728 | F1: 0.743
2025-11-15 09:02:27 | INFO |    验证 - Loss: 0.7342 | Acc: 59.90% | Prec: 0.884 | Rec: 0.228 | F1: 0.362 [最佳]
2025-11-15 09:02:27 | INFO |    学习率: 0.000997 -> 0.000996
2025-11-15 09:02:34 | INFO | Epoch   6/120 | 耗时: 7秒 | ETA: 13.9分钟
2025-11-15 09:02:34 | INFO |    训练 - Loss: 0.4954 | Acc: 76.21% | Prec: 0.780 | Rec: 0.732 | F1: 0.755
2025-11-15 09:02:34 | INFO |    验证 - Loss: 0.6065 | Acc: 68.60% | Prec: 0.919 | Rec: 0.408 | F1: 0.565 [最佳]
2025-11-15 09:02:34 | INFO |    学习率: 0.000996 -> 0.000994
2025-11-15 09:02:41 | INFO | Epoch   7/120 | 耗时: 6秒 | ETA: 13.7分钟
2025-11-15 09:02:41 | INFO |    训练 - Loss: 0.4752 | Acc: 77.60% | Prec: 0.786 | Rec: 0.760 | F1: 0.773
2025-11-15 09:02:41 | INFO |    验证 - Loss: 0.5089 | Acc: 74.50% | Prec: 0.749 | Rec: 0.736 | F1: 0.743 [最佳]
2025-11-15 09:02:41 | INFO |    学习率: 0.000994 -> 0.000992
2025-11-15 09:02:48 | INFO | Epoch   8/120 | 耗时: 7秒 | ETA: 13.5分钟
2025-11-15 09:02:48 | INFO |    训练 - Loss: 0.4526 | Acc: 78.92% | Prec: 0.803 | Rec: 0.766 | F1: 0.784
2025-11-15 09:02:48 | INFO |    验证 - Loss: 0.5075 | Acc: 76.30% | Prec: 0.870 | Rec: 0.618 | F1: 0.723 [最佳]
2025-11-15 09:02:48 | INFO |    学习率: 0.000992 -> 0.000989
2025-11-15 09:02:55 | INFO | Epoch   9/120 | 耗时: 7秒 | ETA: 13.3分钟
2025-11-15 09:02:55 | INFO |    训练 - Loss: 0.4426 | Acc: 79.41% | Prec: 0.798 | Rec: 0.788 | F1: 0.793
2025-11-15 09:02:55 | INFO |    验证 - Loss: 0.5484 | Acc: 72.20% | Prec: 0.747 | Rec: 0.672 | F1: 0.707 
2025-11-15 09:02:55 | INFO |    学习率: 0.000989 -> 0.000986
2025-11-15 09:03:04 | INFO | Epoch  10/120 | 耗时: 8秒 | ETA: 13.5分钟
2025-11-15 09:03:04 | INFO |    训练 - Loss: 0.4241 | Acc: 80.86% | Prec: 0.811 | Rec: 0.804 | F1: 0.808
2025-11-15 09:03:04 | INFO |    验证 - Loss: 0.5055 | Acc: 76.50% | Prec: 0.871 | Rec: 0.622 | F1: 0.726 [最佳]
2025-11-15 09:03:04 | INFO |    学习率: 0.000986 -> 0.000983
2025-11-15 09:03:11 | INFO | Epoch  11/120 | 耗时: 7秒 | ETA: 13.3分钟
2025-11-15 09:03:11 | INFO |    训练 - Loss: 0.3812 | Acc: 83.45% | Prec: 0.848 | Rec: 0.815 | F1: 0.831
2025-11-15 09:03:11 | INFO |    验证 - Loss: 0.4855 | Acc: 76.90% | Prec: 0.750 | Rec: 0.806 | F1: 0.777 [最佳]
2025-11-15 09:03:11 | INFO |    学习率: 0.000983 -> 0.000979
2025-11-15 09:03:18 | INFO | Epoch  12/120 | 耗时: 6秒 | ETA: 13.2分钟
2025-11-15 09:03:18 | INFO |    训练 - Loss: 0.3658 | Acc: 84.01% | Prec: 0.851 | Rec: 0.824 | F1: 0.837
2025-11-15 09:03:18 | INFO |    验证 - Loss: 0.4386 | Acc: 80.40% | Prec: 0.841 | Rec: 0.750 | F1: 0.793 [最佳]
2025-11-15 09:03:18 | INFO |    学习率: 0.000979 -> 0.000976
2025-11-15 09:03:25 | INFO | Epoch  13/120 | 耗时: 7秒 | ETA: 13.0分钟
2025-11-15 09:03:25 | INFO |    训练 - Loss: 0.3310 | Acc: 86.00% | Prec: 0.869 | Rec: 0.849 | F1: 0.859
2025-11-15 09:03:25 | INFO |    验证 - Loss: 0.4829 | Acc: 77.70% | Prec: 0.756 | Rec: 0.818 | F1: 0.786 
2025-11-15 09:03:25 | INFO |    学习率: 0.000976 -> 0.000971
2025-11-15 09:03:32 | INFO | Epoch  14/120 | 耗时: 7秒 | ETA: 12.8分钟
2025-11-15 09:03:32 | INFO |    训练 - Loss: 0.3214 | Acc: 86.42% | Prec: 0.875 | Rec: 0.850 | F1: 0.862
2025-11-15 09:03:32 | INFO |    验证 - Loss: 0.6207 | Acc: 74.40% | Prec: 0.949 | Rec: 0.516 | F1: 0.668 
2025-11-15 09:03:32 | INFO |    学习率: 0.000971 -> 0.000967
2025-11-15 09:03:39 | INFO | Epoch  15/120 | 耗时: 6秒 | ETA: 12.7分钟
2025-11-15 09:03:39 | INFO |    训练 - Loss: 0.2886 | Acc: 87.73% | Prec: 0.880 | Rec: 0.873 | F1: 0.877
2025-11-15 09:03:39 | INFO |    验证 - Loss: 0.6466 | Acc: 73.60% | Prec: 0.934 | Rec: 0.508 | F1: 0.658 
2025-11-15 09:03:39 | INFO |    学习率: 0.000967 -> 0.000962
2025-11-15 09:03:46 | INFO | Epoch  16/120 | 耗时: 6秒 | ETA: 12.5分钟
2025-11-15 09:03:46 | INFO |    训练 - Loss: 0.2562 | Acc: 89.35% | Prec: 0.901 | Rec: 0.883 | F1: 0.892
2025-11-15 09:03:46 | INFO |    验证 - Loss: 0.3976 | Acc: 83.20% | Prec: 0.837 | Rec: 0.824 | F1: 0.831 [最佳]
2025-11-15 09:03:46 | INFO |    学习率: 0.000962 -> 0.000957
2025-11-15 09:03:53 | INFO | Epoch  17/120 | 耗时: 6秒 | ETA: 12.4分钟
2025-11-15 09:03:53 | INFO |    训练 - Loss: 0.2324 | Acc: 90.43% | Prec: 0.915 | Rec: 0.891 | F1: 0.903
2025-11-15 09:03:53 | INFO |    验证 - Loss: 0.3777 | Acc: 83.80% | Prec: 0.851 | Rec: 0.820 | F1: 0.835 [最佳]
2025-11-15 09:03:53 | INFO |    学习率: 0.000957 -> 0.000951
2025-11-15 09:04:00 | INFO | Epoch  18/120 | 耗时: 7秒 | ETA: 12.2分钟
2025-11-15 09:04:00 | INFO |    训练 - Loss: 0.2079 | Acc: 92.04% | Prec: 0.926 | Rec: 0.914 | F1: 0.920
2025-11-15 09:04:00 | INFO |    验证 - Loss: 0.4297 | Acc: 83.60% | Prec: 0.916 | Rec: 0.740 | F1: 0.819 
2025-11-15 09:04:00 | INFO |    学习率: 0.000951 -> 0.000946
2025-11-15 09:04:07 | INFO | Epoch  19/120 | 耗时: 6秒 | ETA: 12.1分钟
2025-11-15 09:04:07 | INFO |    训练 - Loss: 0.1850 | Acc: 92.67% | Prec: 0.932 | Rec: 0.921 | F1: 0.926
2025-11-15 09:04:07 | INFO |    验证 - Loss: 0.3473 | Acc: 86.40% | Prec: 0.843 | Rec: 0.894 | F1: 0.868 [最佳]
2025-11-15 09:04:07 | INFO |    学习率: 0.000946 -> 0.000939
2025-11-15 09:04:16 | INFO | Epoch  20/120 | 耗时: 8秒 | ETA: 12.1分钟
2025-11-15 09:04:16 | INFO |    训练 - Loss: 0.1490 | Acc: 94.56% | Prec: 0.950 | Rec: 0.940 | F1: 0.945
2025-11-15 09:04:16 | INFO |    验证 - Loss: 0.5425 | Acc: 78.90% | Prec: 0.937 | Rec: 0.620 | F1: 0.746 
2025-11-15 09:04:16 | INFO |    学习率: 0.000939 -> 0.000933
2025-11-15 09:04:23 | INFO | Epoch  21/120 | 耗时: 6秒 | ETA: 12.0分钟
2025-11-15 09:04:23 | INFO |    训练 - Loss: 0.1389 | Acc: 94.86% | Prec: 0.947 | Rec: 0.950 | F1: 0.948
2025-11-15 09:04:23 | INFO |    验证 - Loss: 0.5218 | Acc: 82.50% | Prec: 0.754 | Rec: 0.964 | F1: 0.846 
2025-11-15 09:04:23 | INFO |    学习率: 0.000933 -> 0.000926
2025-11-15 09:04:30 | INFO | Epoch  22/120 | 耗时: 7秒 | ETA: 11.8分钟
2025-11-15 09:04:30 | INFO |    训练 - Loss: 0.1229 | Acc: 95.47% | Prec: 0.959 | Rec: 0.950 | F1: 0.955
2025-11-15 09:04:30 | INFO |    验证 - Loss: 0.4085 | Acc: 86.30% | Prec: 0.864 | Rec: 0.862 | F1: 0.863 
2025-11-15 09:04:30 | INFO |    学习率: 0.000926 -> 0.000919
2025-11-15 09:04:37 | INFO | Epoch  23/120 | 耗时: 7秒 | ETA: 11.7分钟
2025-11-15 09:04:37 | INFO |    训练 - Loss: 0.1159 | Acc: 95.78% | Prec: 0.965 | Rec: 0.950 | F1: 0.957
2025-11-15 09:04:37 | INFO |    验证 - Loss: 0.3391 | Acc: 86.50% | Prec: 0.878 | Rec: 0.848 | F1: 0.863 [最佳]
2025-11-15 09:04:37 | INFO |    学习率: 0.000919 -> 0.000912
2025-11-15 09:04:44 | INFO | Epoch  24/120 | 耗时: 7秒 | ETA: 11.6分钟
2025-11-15 09:04:44 | INFO |    训练 - Loss: 0.0932 | Acc: 96.71% | Prec: 0.971 | Rec: 0.963 | F1: 0.967
2025-11-15 09:04:44 | INFO |    验证 - Loss: 0.3599 | Acc: 87.50% | Prec: 0.856 | Rec: 0.902 | F1: 0.878 [最佳]
2025-11-15 09:04:44 | INFO |    学习率: 0.000912 -> 0.000905
2025-11-15 09:04:51 | INFO | Epoch  25/120 | 耗时: 6秒 | ETA: 11.4分钟
2025-11-15 09:04:51 | INFO |    训练 - Loss: 0.0697 | Acc: 97.88% | Prec: 0.979 | Rec: 0.978 | F1: 0.979
2025-11-15 09:04:51 | INFO |    验证 - Loss: 0.4094 | Acc: 85.40% | Prec: 0.799 | Rec: 0.946 | F1: 0.866 
2025-11-15 09:04:51 | INFO |    学习率: 0.000905 -> 0.000897
2025-11-15 09:04:58 | INFO | Epoch  26/120 | 耗时: 7秒 | ETA: 11.3分钟
2025-11-15 09:04:58 | INFO |    训练 - Loss: 0.0547 | Acc: 98.41% | Prec: 0.988 | Rec: 0.980 | F1: 0.984
2025-11-15 09:04:58 | INFO |    验证 - Loss: 0.3237 | Acc: 88.10% | Prec: 0.911 | Rec: 0.844 | F1: 0.876 [最佳]
2025-11-15 09:04:58 | INFO |    学习率: 0.000897 -> 0.000889
2025-11-15 09:05:05 | INFO | Epoch  27/120 | 耗时: 7秒 | ETA: 11.2分钟
2025-11-15 09:05:05 | INFO |    训练 - Loss: 0.0389 | Acc: 98.96% | Prec: 0.992 | Rec: 0.987 | F1: 0.990
2025-11-15 09:05:05 | INFO |    验证 - Loss: 0.3710 | Acc: 87.60% | Prec: 0.848 | Rec: 0.916 | F1: 0.881 
2025-11-15 09:05:05 | INFO |    学习率: 0.000889 -> 0.000880
2025-11-15 09:05:12 | INFO | Epoch  28/120 | 耗时: 7秒 | ETA: 11.0分钟
2025-11-15 09:05:12 | INFO |    训练 - Loss: 0.0330 | Acc: 99.23% | Prec: 0.993 | Rec: 0.992 | F1: 0.992
2025-11-15 09:05:12 | INFO |    验证 - Loss: 0.3253 | Acc: 88.20% | Prec: 0.866 | Rec: 0.904 | F1: 0.885 [最佳]
2025-11-15 09:05:12 | INFO |    学习率: 0.000880 -> 0.000872
2025-11-15 09:05:19 | INFO | Epoch  29/120 | 耗时: 6秒 | ETA: 10.9分钟
2025-11-15 09:05:19 | INFO |    训练 - Loss: 0.0245 | Acc: 99.51% | Prec: 0.996 | Rec: 0.995 | F1: 0.995
2025-11-15 09:05:19 | INFO |    验证 - Loss: 0.3418 | Acc: 88.00% | Prec: 0.886 | Rec: 0.872 | F1: 0.879 
2025-11-15 09:05:19 | INFO |    学习率: 0.000872 -> 0.000863
2025-11-15 09:05:27 | INFO | Epoch  30/120 | 耗时: 8秒 | ETA: 10.8分钟
2025-11-15 09:05:27 | INFO |    训练 - Loss: 0.0191 | Acc: 99.58% | Prec: 0.996 | Rec: 0.995 | F1: 0.996
2025-11-15 09:05:27 | INFO |    验证 - Loss: 0.5250 | Acc: 85.40% | Prec: 0.932 | Rec: 0.764 | F1: 0.840 
2025-11-15 09:05:27 | INFO |    学习率: 0.000863 -> 0.000854
2025-11-15 09:05:34 | INFO | Epoch  31/120 | 耗时: 6秒 | ETA: 10.7分钟
2025-11-15 09:05:34 | INFO |    训练 - Loss: 0.0129 | Acc: 99.84% | Prec: 0.999 | Rec: 0.998 | F1: 0.998
2025-11-15 09:05:34 | INFO |    验证 - Loss: 0.4131 | Acc: 88.90% | Prec: 0.891 | Rec: 0.886 | F1: 0.889 [最佳]
2025-11-15 09:05:34 | INFO |    学习率: 0.000854 -> 0.000844
2025-11-15 09:05:41 | INFO | Epoch  32/120 | 耗时: 7秒 | ETA: 10.6分钟
2025-11-15 09:05:41 | INFO |    训练 - Loss: 0.0106 | Acc: 99.87% | Prec: 0.999 | Rec: 0.998 | F1: 0.999
2025-11-15 09:05:41 | INFO |    验证 - Loss: 0.4155 | Acc: 88.90% | Prec: 0.866 | Rec: 0.920 | F1: 0.892 
2025-11-15 09:05:41 | INFO |    学习率: 0.000844 -> 0.000835
2025-11-15 09:05:49 | INFO | Epoch  33/120 | 耗时: 7秒 | ETA: 10.5分钟
2025-11-15 09:05:49 | INFO |    训练 - Loss: 0.0099 | Acc: 99.87% | Prec: 0.999 | Rec: 0.999 | F1: 0.999
2025-11-15 09:05:49 | INFO |    验证 - Loss: 0.9862 | Acc: 75.20% | Prec: 0.974 | Rec: 0.518 | F1: 0.676 
2025-11-15 09:05:49 | INFO |    学习率: 0.000835 -> 0.000825
2025-11-15 09:05:56 | INFO | Epoch  34/120 | 耗时: 7秒 | ETA: 10.3分钟
2025-11-15 09:05:56 | INFO |    训练 - Loss: 0.0079 | Acc: 99.99% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:05:56 | INFO |    验证 - Loss: 0.4461 | Acc: 88.40% | Prec: 0.923 | Rec: 0.838 | F1: 0.878 
2025-11-15 09:05:56 | INFO |    学习率: 0.000825 -> 0.000815
2025-11-15 09:06:03 | INFO | Epoch  35/120 | 耗时: 6秒 | ETA: 10.2分钟
2025-11-15 09:06:03 | INFO |    训练 - Loss: 0.0056 | Acc: 99.96% | Prec: 1.000 | Rec: 0.999 | F1: 1.000
2025-11-15 09:06:03 | INFO |    验证 - Loss: 0.4224 | Acc: 88.20% | Prec: 0.898 | Rec: 0.862 | F1: 0.880 
2025-11-15 09:06:03 | INFO |    学习率: 0.000815 -> 0.000804
2025-11-15 09:06:10 | INFO | Epoch  36/120 | 耗时: 7秒 | ETA: 10.1分钟
2025-11-15 09:06:10 | INFO |    训练 - Loss: 0.0043 | Acc: 99.99% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:06:10 | INFO |    验证 - Loss: 0.4190 | Acc: 89.10% | Prec: 0.881 | Rec: 0.904 | F1: 0.892 [最佳]
2025-11-15 09:06:10 | INFO |    学习率: 0.000804 -> 0.000794
2025-11-15 09:06:17 | INFO | Epoch  37/120 | 耗时: 6秒 | ETA: 10.0分钟
2025-11-15 09:06:17 | INFO |    训练 - Loss: 0.0045 | Acc: 99.95% | Prec: 1.000 | Rec: 0.999 | F1: 0.999
2025-11-15 09:06:17 | INFO |    验证 - Loss: 0.5562 | Acc: 85.50% | Prec: 0.949 | Rec: 0.750 | F1: 0.838 
2025-11-15 09:06:17 | INFO |    学习率: 0.000794 -> 0.000783
2025-11-15 09:06:24 | INFO | Epoch  38/120 | 耗时: 7秒 | ETA: 9.8分钟
2025-11-15 09:06:24 | INFO |    训练 - Loss: 0.0042 | Acc: 99.99% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:06:24 | INFO |    验证 - Loss: 0.4346 | Acc: 89.00% | Prec: 0.895 | Rec: 0.884 | F1: 0.889 
2025-11-15 09:06:24 | INFO |    学习率: 0.000783 -> 0.000772
2025-11-15 09:06:31 | INFO | Epoch  39/120 | 耗时: 6秒 | ETA: 9.7分钟
2025-11-15 09:06:31 | INFO |    训练 - Loss: 0.0043 | Acc: 99.95% | Prec: 1.000 | Rec: 0.999 | F1: 0.999
2025-11-15 09:06:31 | INFO |    验证 - Loss: 0.4422 | Acc: 88.20% | Prec: 0.879 | Rec: 0.886 | F1: 0.882 
2025-11-15 09:06:31 | INFO |    学习率: 0.000772 -> 0.000761
2025-11-15 09:06:40 | INFO | Epoch  40/120 | 耗时: 8秒 | ETA: 9.6分钟
2025-11-15 09:06:40 | INFO |    训练 - Loss: 0.0050 | Acc: 99.97% | Prec: 1.000 | Rec: 0.999 | F1: 1.000
2025-11-15 09:06:40 | INFO |    验证 - Loss: 0.4719 | Acc: 88.50% | Prec: 0.925 | Rec: 0.838 | F1: 0.879 
2025-11-15 09:06:40 | INFO |    学习率: 0.000761 -> 0.000750
2025-11-15 09:06:47 | INFO | Epoch  41/120 | 耗时: 7秒 | ETA: 9.5分钟
2025-11-15 09:06:47 | INFO |    训练 - Loss: 0.0031 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:06:47 | INFO |    验证 - Loss: 0.5162 | Acc: 88.10% | Prec: 0.843 | Rec: 0.936 | F1: 0.887 
2025-11-15 09:06:47 | INFO |    学习率: 0.000750 -> 0.000739
2025-11-15 09:06:54 | INFO | Epoch  42/120 | 耗时: 6秒 | ETA: 9.4分钟
2025-11-15 09:06:54 | INFO |    训练 - Loss: 0.0019 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:06:54 | INFO |    验证 - Loss: 0.4529 | Acc: 89.20% | Prec: 0.915 | Rec: 0.864 | F1: 0.889 [最佳]
2025-11-15 09:06:54 | INFO |    学习率: 0.000739 -> 0.000727
2025-11-15 09:07:01 | INFO | Epoch  43/120 | 耗时: 6秒 | ETA: 9.3分钟
2025-11-15 09:07:01 | INFO |    训练 - Loss: 0.0015 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:07:01 | INFO |    验证 - Loss: 0.4353 | Acc: 89.30% | Prec: 0.892 | Rec: 0.894 | F1: 0.893 [最佳]
2025-11-15 09:07:01 | INFO |    学习率: 0.000727 -> 0.000715
2025-11-15 09:07:08 | INFO | Epoch  44/120 | 耗时: 6秒 | ETA: 9.1分钟
2025-11-15 09:07:08 | INFO |    训练 - Loss: 0.0012 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:07:08 | INFO |    验证 - Loss: 0.4265 | Acc: 89.40% | Prec: 0.904 | Rec: 0.882 | F1: 0.893 [最佳]
2025-11-15 09:07:08 | INFO |    学习率: 0.000715 -> 0.000703
2025-11-15 09:07:15 | INFO | Epoch  45/120 | 耗时: 7秒 | ETA: 9.0分钟
2025-11-15 09:07:15 | INFO |    训练 - Loss: 0.0010 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:07:15 | INFO |    验证 - Loss: 0.4335 | Acc: 88.80% | Prec: 0.894 | Rec: 0.880 | F1: 0.887 
2025-11-15 09:07:15 | INFO |    学习率: 0.000703 -> 0.000691
2025-11-15 09:07:22 | INFO | Epoch  46/120 | 耗时: 6秒 | ETA: 8.9分钟
2025-11-15 09:07:22 | INFO |    训练 - Loss: 0.0009 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:07:22 | INFO |    验证 - Loss: 0.4381 | Acc: 89.30% | Prec: 0.910 | Rec: 0.872 | F1: 0.891 
2025-11-15 09:07:22 | INFO |    学习率: 0.000691 -> 0.000679
2025-11-15 09:07:29 | INFO | Epoch  47/120 | 耗时: 6秒 | ETA: 8.8分钟
2025-11-15 09:07:29 | INFO |    训练 - Loss: 0.0010 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:07:29 | INFO |    验证 - Loss: 0.5025 | Acc: 88.30% | Prec: 0.942 | Rec: 0.816 | F1: 0.875 
2025-11-15 09:07:29 | INFO |    学习率: 0.000679 -> 0.000667
2025-11-15 09:07:36 | INFO | Epoch  48/120 | 耗时: 7秒 | ETA: 8.6分钟
2025-11-15 09:07:36 | INFO |    训练 - Loss: 0.0010 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:07:36 | INFO |    验证 - Loss: 0.4375 | Acc: 89.10% | Prec: 0.892 | Rec: 0.890 | F1: 0.891 
2025-11-15 09:07:36 | INFO |    学习率: 0.000667 -> 0.000655
2025-11-15 09:07:43 | INFO | Epoch  49/120 | 耗时: 7秒 | ETA: 8.5分钟
2025-11-15 09:07:43 | INFO |    训练 - Loss: 0.0008 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:07:43 | INFO |    验证 - Loss: 0.4474 | Acc: 89.40% | Prec: 0.896 | Rec: 0.892 | F1: 0.894 
2025-11-15 09:07:43 | INFO |    学习率: 0.000655 -> 0.000642
2025-11-15 09:07:51 | INFO | Epoch  50/120 | 耗时: 8秒 | ETA: 8.4分钟
2025-11-15 09:07:51 | INFO |    训练 - Loss: 0.0008 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:07:51 | INFO |    验证 - Loss: 0.4415 | Acc: 89.30% | Prec: 0.894 | Rec: 0.892 | F1: 0.893 
2025-11-15 09:07:51 | INFO |    学习率: 0.000642 -> 0.000629
2025-11-15 09:07:58 | INFO | Epoch  51/120 | 耗时: 6秒 | ETA: 8.3分钟
2025-11-15 09:07:58 | INFO |    训练 - Loss: 0.0007 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:07:58 | INFO |    验证 - Loss: 0.4444 | Acc: 89.10% | Prec: 0.901 | Rec: 0.878 | F1: 0.890 
2025-11-15 09:07:58 | INFO |    学习率: 0.000629 -> 0.000617
2025-11-15 09:08:05 | INFO | Epoch  52/120 | 耗时: 6秒 | ETA: 8.2分钟
2025-11-15 09:08:05 | INFO |    训练 - Loss: 0.0007 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:08:05 | INFO |    验证 - Loss: 0.4529 | Acc: 89.40% | Prec: 0.882 | Rec: 0.910 | F1: 0.896 
2025-11-15 09:08:05 | INFO |    学习率: 0.000617 -> 0.000604
2025-11-15 09:08:12 | INFO | Epoch  53/120 | 耗时: 7秒 | ETA: 8.0分钟
2025-11-15 09:08:12 | INFO |    训练 - Loss: 0.0007 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:08:12 | INFO |    验证 - Loss: 0.4460 | Acc: 89.80% | Prec: 0.893 | Rec: 0.904 | F1: 0.899 [最佳]
2025-11-15 09:08:12 | INFO |    学习率: 0.000604 -> 0.000591
2025-11-15 09:08:19 | INFO | Epoch  54/120 | 耗时: 6秒 | ETA: 7.9分钟
2025-11-15 09:08:19 | INFO |    训练 - Loss: 0.0007 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:08:19 | INFO |    验证 - Loss: 0.4540 | Acc: 89.00% | Prec: 0.910 | Rec: 0.866 | F1: 0.887 
2025-11-15 09:08:19 | INFO |    学习率: 0.000591 -> 0.000578
2025-11-15 09:08:26 | INFO | Epoch  55/120 | 耗时: 6秒 | ETA: 7.8分钟
2025-11-15 09:08:26 | INFO |    训练 - Loss: 0.0008 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:08:26 | INFO |    验证 - Loss: 0.4543 | Acc: 89.40% | Prec: 0.889 | Rec: 0.900 | F1: 0.895 
2025-11-15 09:08:26 | INFO |    学习率: 0.000578 -> 0.000565
2025-11-15 09:08:33 | INFO | Epoch  56/120 | 耗时: 6秒 | ETA: 7.7分钟
2025-11-15 09:08:33 | INFO |    训练 - Loss: 0.0007 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:08:33 | INFO |    验证 - Loss: 0.4653 | Acc: 88.90% | Prec: 0.869 | Rec: 0.916 | F1: 0.892 
2025-11-15 09:08:33 | INFO |    学习率: 0.000565 -> 0.000552
2025-11-15 09:08:40 | INFO | Epoch  57/120 | 耗时: 7秒 | ETA: 7.5分钟
2025-11-15 09:08:40 | INFO |    训练 - Loss: 0.0007 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:08:40 | INFO |    验证 - Loss: 0.4483 | Acc: 89.60% | Prec: 0.896 | Rec: 0.896 | F1: 0.896 
2025-11-15 09:08:40 | INFO |    学习率: 0.000552 -> 0.000539
2025-11-15 09:08:47 | INFO | Epoch  58/120 | 耗时: 6秒 | ETA: 7.4分钟
2025-11-15 09:08:47 | INFO |    训练 - Loss: 0.0007 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:08:47 | INFO |    验证 - Loss: 0.4553 | Acc: 88.80% | Prec: 0.901 | Rec: 0.872 | F1: 0.886 
2025-11-15 09:08:47 | INFO |    学习率: 0.000539 -> 0.000526
2025-11-15 09:08:54 | INFO | Epoch  59/120 | 耗时: 7秒 | ETA: 7.3分钟
2025-11-15 09:08:54 | INFO |    训练 - Loss: 0.0006 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:08:54 | INFO |    验证 - Loss: 0.4503 | Acc: 89.70% | Prec: 0.896 | Rec: 0.898 | F1: 0.897 
2025-11-15 09:08:54 | INFO |    学习率: 0.000526 -> 0.000513
2025-11-15 09:09:03 | INFO | Epoch  60/120 | 耗时: 8秒 | ETA: 7.2分钟
2025-11-15 09:09:03 | INFO |    训练 - Loss: 0.0006 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:09:03 | INFO |    验证 - Loss: 0.4533 | Acc: 89.10% | Prec: 0.892 | Rec: 0.890 | F1: 0.891 
2025-11-15 09:09:03 | INFO |    学习率: 0.000513 -> 0.000500
2025-11-15 09:09:10 | INFO | Epoch  61/120 | 耗时: 7秒 | ETA: 7.1分钟
2025-11-15 09:09:10 | INFO |    训练 - Loss: 0.0006 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:09:10 | INFO |    验证 - Loss: 0.4513 | Acc: 89.60% | Prec: 0.893 | Rec: 0.900 | F1: 0.896 
2025-11-15 09:09:10 | INFO |    学习率: 0.000500 -> 0.000487
2025-11-15 09:09:17 | INFO | Epoch  62/120 | 耗时: 6秒 | ETA: 7.0分钟
2025-11-15 09:09:17 | INFO |    训练 - Loss: 0.0006 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:09:17 | INFO |    验证 - Loss: 0.4597 | Acc: 89.40% | Prec: 0.888 | Rec: 0.902 | F1: 0.895 
2025-11-15 09:09:17 | INFO |    学习率: 0.000487 -> 0.000474
2025-11-15 09:09:24 | INFO | Epoch  63/120 | 耗时: 6秒 | ETA: 6.8分钟
2025-11-15 09:09:24 | INFO |    训练 - Loss: 0.0006 | Acc: 100.00% | Prec: 1.000 | Rec: 1.000 | F1: 1.000
2025-11-15 09:09:24 | INFO |    验证 - Loss: 0.4560 | Acc: 89.30% | Prec: 0.902 | Rec: 0.882 | F1: 0.892 
2025-11-15 09:09:24 | INFO |    学习率: 0.000474 -> 0.000461
2025-11-15 09:09:24 | INFO | 
触发早停 (连续 10 轮 accuracy 无改善)
2025-11-15 09:09:24 | INFO | 训练完成
2025-11-15 09:09:24 | INFO | 训练总结
2025-11-15 09:09:24 | INFO |   总耗时: 7.6分钟
2025-11-15 09:09:24 | INFO |   平均每轮: 7秒
2025-11-15 09:09:24 | INFO |   完成轮数: 63/120
2025-11-15 09:09:24 | INFO |   最佳验证: Epoch 53 - ACCURACY: 0.8980, Loss: 0.4460, Acc: 89.80%
2025-11-15 09:09:24 | INFO | 
正在测试集上评估最佳模型...
2025-11-15 09:09:24 | INFO |    已加载最佳模型 (Epoch 53)
2025-11-15 09:09:26 | INFO | 测试结果
2025-11-15 09:09:26 | INFO |   测试样本数: 1,000
2025-11-15 09:09:26 | INFO |   测试损失: 0.3462
2025-11-15 09:09:26 | INFO |   测试准确率: 91.60%
2025-11-15 09:09:26 | INFO |   测试精确率: 0.916
2025-11-15 09:09:26 | INFO |   测试召回率: 0.916
2025-11-15 09:09:26 | INFO |   测试F1: 0.916
2025-11-15 09:09:26 | INFO | 
正在生成训练曲线可视化...
2025-11-15 09:09:27 | INFO |    训练曲线已保存到: runs/torch_cnn-v2_20251115-090146/figures
2025-11-15 09:09:27 | INFO | 
所有任务完成!
2025-11-15 09:09:27 | INFO |    最佳模型: runs/torch_cnn-v2_20251115-090146/best.pt
2025-11-15 09:09:27 | INFO |    最后模型: runs/torch_cnn-v2_20251115-090146/last.pt
2025-11-15 09:09:27 | INFO |    TensorBoard: tensorboard --logdir=runs/torch_cnn-v2_20251115-090146/events

2025-11-15 09:09:27 | INFO | 训练完成
2025-11-15 09:09:27 | INFO |   耗时: 7.7分钟
2025-11-15 09:09:27 | INFO |   最佳准确率: 0.8980
2025-11-15 09:09:27 | INFO |   运行目录: runs/torch_cnn-v2_20251115-090146
2025-11-15 09:09:27 | INFO | CNN-V2 训练流程完成
