2025-11-14 10:42:45 | INFO | 开始训练
2025-11-14 10:42:45 | INFO |   arch: resnet18
2025-11-14 10:42:45 | INFO |   data_dir: dataset
2025-11-14 10:42:45 | INFO |   batch_size: 512
2025-11-14 10:42:45 | INFO |   epochs: 120
2025-11-14 10:42:45 | INFO | 启动 RESNET18 训练流程
2025-11-14 10:42:45 | INFO | 猫狗分类 - ResNet18 训练
2025-11-14 10:42:45 | INFO | 运行环境
2025-11-14 10:42:45 | INFO |   计算设备: CUDA
2025-11-14 10:42:45 | INFO |   GPU型号: NVIDIA GeForce RTX 3090
2025-11-14 10:42:45 | INFO |   GPU内存: 23.7 GB
2025-11-14 10:42:45 | INFO |   混合精度(AMP): 启用
2025-11-14 10:42:45 | INFO | 
正在加载数据集...
2025-11-14 10:42:45 | INFO | 数据集信息
2025-11-14 10:42:45 | INFO |   训练样本数: 8,000 (88.9%)
2025-11-14 10:42:45 | INFO |   验证样本数: 1,000 (11.1%)
2025-11-14 10:42:45 | INFO |   测试样本数: 1,000
2025-11-14 10:42:45 | INFO |   类别数量: 2 (cats, dogs)
2025-11-14 10:42:45 | INFO |   每轮步数: 15
2025-11-14 10:42:45 | INFO | 模型配置
2025-11-14 10:42:45 | INFO |   模型架构: ResNet18
2025-11-14 10:42:45 | INFO |   参数总量: 11,439,681
2025-11-14 10:42:45 | INFO |   可训练参数: 263,169
2025-11-14 10:42:45 | INFO |   图像尺寸: 224x224
2025-11-14 10:42:45 | INFO |   Dropout: 0.0
2025-11-14 10:42:45 | INFO |   标准化: 默认[0,1]
2025-11-14 10:42:45 | INFO |   数据增强: 启用
2025-11-14 10:42:45 | INFO | 
计算数据集类别分布...
2025-11-14 10:42:50 | INFO | 训练配置
2025-11-14 10:42:50 | INFO |   训练轮数: 120
2025-11-14 10:42:50 | INFO |   批次大小: 512
2025-11-14 10:42:50 | INFO |   优化器: ADAM
2025-11-14 10:42:50 | INFO |   初始学习率: 0.001
2025-11-14 10:42:50 | INFO |   权重衰减: 0.0001
2025-11-14 10:42:50 | INFO |   学习率调度: cosine
2025-11-14 10:42:50 | INFO |   早停耐心值: 10
2025-11-14 10:42:50 | INFO |   早停评估指标: accuracy
2025-11-14 10:42:50 | INFO |   工作进程数: 16
2025-11-14 10:42:50 | INFO |   类别权重: cats=1.00, dogs=1.00
2025-11-14 10:42:50 | INFO | 
TensorBoard日志目录: runs/torch_resnet18_20251114-104245/events
2025-11-14 10:42:50 | INFO | 模型保存目录: runs/torch_resnet18_20251114-104245
2025-11-14 10:42:50 | INFO | 训练日志: runs/torch_resnet18_20251114-104245/resnet18.log
2025-11-14 10:42:52 | INFO | 开始训练
2025-11-14 10:43:01 | INFO | Epoch   1/120 | 耗时: 9秒 | ETA: 19.4分钟
2025-11-14 10:43:01 | INFO |    训练 - Loss: 0.2650 | Acc: 88.88% | Prec: 0.897 | Rec: 0.878 | F1: 0.888
2025-11-14 10:43:01 | INFO |    验证 - Loss: 0.0970 | Acc: 95.50% | Prec: 0.977 | Rec: 0.932 | F1: 0.954 [最佳]
2025-11-14 10:43:01 | INFO |    学习率: 0.001000 -> 0.001000
2025-11-14 10:43:11 | INFO | Epoch   2/120 | 耗时: 9秒 | ETA: 18.7分钟
2025-11-14 10:43:11 | INFO |    训练 - Loss: 0.0958 | Acc: 96.13% | Prec: 0.964 | Rec: 0.958 | F1: 0.961
2025-11-14 10:43:11 | INFO |    验证 - Loss: 0.0633 | Acc: 97.10% | Prec: 0.990 | Rec: 0.952 | F1: 0.970 [最佳]
2025-11-14 10:43:11 | INFO |    学习率: 0.001000 -> 0.000999
2025-11-14 10:43:20 | INFO | Epoch   3/120 | 耗时: 9秒 | ETA: 18.4分钟
2025-11-14 10:43:20 | INFO |    训练 - Loss: 0.0777 | Acc: 96.59% | Prec: 0.969 | Rec: 0.963 | F1: 0.966
2025-11-14 10:43:20 | INFO |    验证 - Loss: 0.0547 | Acc: 97.60% | Prec: 0.980 | Rec: 0.972 | F1: 0.976 [最佳]
2025-11-14 10:43:20 | INFO |    学习率: 0.000999 -> 0.000998
2025-11-14 10:43:28 | INFO | Epoch   4/120 | 耗时: 8秒 | ETA: 17.7分钟
2025-11-14 10:43:28 | INFO |    训练 - Loss: 0.0714 | Acc: 97.06% | Prec: 0.971 | Rec: 0.970 | F1: 0.971
2025-11-14 10:43:28 | INFO |    验证 - Loss: 0.0708 | Acc: 96.80% | Prec: 0.992 | Rec: 0.944 | F1: 0.967 
2025-11-14 10:43:28 | INFO |    学习率: 0.000998 -> 0.000997
2025-11-14 10:43:37 | INFO | Epoch   5/120 | 耗时: 8秒 | ETA: 17.2分钟
2025-11-14 10:43:37 | INFO |    训练 - Loss: 0.0718 | Acc: 97.01% | Prec: 0.972 | Rec: 0.967 | F1: 0.970
2025-11-14 10:43:37 | INFO |    验证 - Loss: 0.0576 | Acc: 97.50% | Prec: 0.984 | Rec: 0.966 | F1: 0.975 
2025-11-14 10:43:37 | INFO |    学习率: 0.000997 -> 0.000996
2025-11-14 10:43:46 | INFO | Epoch   6/120 | 耗时: 9秒 | ETA: 17.2分钟
2025-11-14 10:43:46 | INFO |    训练 - Loss: 0.0705 | Acc: 97.37% | Prec: 0.975 | Rec: 0.972 | F1: 0.974
2025-11-14 10:43:46 | INFO |    验证 - Loss: 0.0562 | Acc: 97.80% | Prec: 0.986 | Rec: 0.970 | F1: 0.978 [最佳]
2025-11-14 10:43:46 | INFO |    学习率: 0.000996 -> 0.000994
2025-11-14 10:43:55 | INFO | Epoch   7/120 | 耗时: 8秒 | ETA: 17.0分钟
2025-11-14 10:43:55 | INFO |    训练 - Loss: 0.0785 | Acc: 96.78% | Prec: 0.972 | Rec: 0.963 | F1: 0.968
2025-11-14 10:43:55 | INFO |    验证 - Loss: 0.0533 | Acc: 97.90% | Prec: 0.986 | Rec: 0.972 | F1: 0.979 [最佳]
2025-11-14 10:43:55 | INFO |    学习率: 0.000994 -> 0.000992
2025-11-14 10:44:03 | INFO | Epoch   8/120 | 耗时: 8秒 | ETA: 16.7分钟
2025-11-14 10:44:03 | INFO |    训练 - Loss: 0.0679 | Acc: 97.50% | Prec: 0.977 | Rec: 0.973 | F1: 0.975
2025-11-14 10:44:03 | INFO |    验证 - Loss: 0.0550 | Acc: 97.80% | Prec: 0.988 | Rec: 0.968 | F1: 0.978 
2025-11-14 10:44:03 | INFO |    学习率: 0.000992 -> 0.000989
2025-11-14 10:44:11 | INFO | Epoch   9/120 | 耗时: 8秒 | ETA: 16.4分钟
2025-11-14 10:44:11 | INFO |    训练 - Loss: 0.0669 | Acc: 97.36% | Prec: 0.975 | Rec: 0.972 | F1: 0.973
2025-11-14 10:44:11 | INFO |    验证 - Loss: 0.0546 | Acc: 97.70% | Prec: 0.984 | Rec: 0.970 | F1: 0.977 
2025-11-14 10:44:11 | INFO |    学习率: 0.000989 -> 0.000986
2025-11-14 10:44:22 | INFO | Epoch  10/120 | 耗时: 11秒 | ETA: 16.7分钟
2025-11-14 10:44:22 | INFO |    训练 - Loss: 0.0683 | Acc: 97.20% | Prec: 0.974 | Rec: 0.970 | F1: 0.972
2025-11-14 10:44:22 | INFO |    验证 - Loss: 0.0520 | Acc: 98.00% | Prec: 0.986 | Rec: 0.974 | F1: 0.980 [最佳]
2025-11-14 10:44:22 | INFO |    学习率: 0.000986 -> 0.000983
2025-11-14 10:44:31 | INFO | Epoch  11/120 | 耗时: 8秒 | ETA: 16.4分钟
2025-11-14 10:44:31 | INFO |    训练 - Loss: 0.0654 | Acc: 97.34% | Prec: 0.976 | Rec: 0.971 | F1: 0.973
2025-11-14 10:44:31 | INFO |    验证 - Loss: 0.0518 | Acc: 97.90% | Prec: 0.986 | Rec: 0.972 | F1: 0.979 
2025-11-14 10:44:31 | INFO |    学习率: 0.000983 -> 0.000979
2025-11-14 10:44:39 | INFO | Epoch  12/120 | 耗时: 8秒 | ETA: 16.2分钟
2025-11-14 10:44:39 | INFO |    训练 - Loss: 0.0648 | Acc: 97.46% | Prec: 0.977 | Rec: 0.972 | F1: 0.975
2025-11-14 10:44:39 | INFO |    验证 - Loss: 0.0520 | Acc: 97.80% | Prec: 0.986 | Rec: 0.970 | F1: 0.978 
2025-11-14 10:44:39 | INFO |    学习率: 0.000979 -> 0.000976
2025-11-14 10:44:49 | INFO | Epoch  13/120 | 耗时: 9秒 | ETA: 16.0分钟
2025-11-14 10:44:49 | INFO |    训练 - Loss: 0.0701 | Acc: 97.30% | Prec: 0.974 | Rec: 0.972 | F1: 0.973
2025-11-14 10:44:49 | INFO |    验证 - Loss: 0.0518 | Acc: 98.10% | Prec: 0.988 | Rec: 0.974 | F1: 0.981 [最佳]
2025-11-14 10:44:49 | INFO |    学习率: 0.000976 -> 0.000971
2025-11-14 10:44:57 | INFO | Epoch  14/120 | 耗时: 8秒 | ETA: 15.8分钟
2025-11-14 10:44:57 | INFO |    训练 - Loss: 0.0584 | Acc: 97.70% | Prec: 0.977 | Rec: 0.977 | F1: 0.977
2025-11-14 10:44:57 | INFO |    验证 - Loss: 0.0712 | Acc: 97.30% | Prec: 0.994 | Rec: 0.952 | F1: 0.972 
2025-11-14 10:44:57 | INFO |    学习率: 0.000971 -> 0.000967
2025-11-14 10:45:06 | INFO | Epoch  15/120 | 耗时: 8秒 | ETA: 15.6分钟
2025-11-14 10:45:06 | INFO |    训练 - Loss: 0.0676 | Acc: 97.25% | Prec: 0.977 | Rec: 0.968 | F1: 0.972
2025-11-14 10:45:06 | INFO |    验证 - Loss: 0.0532 | Acc: 98.00% | Prec: 0.980 | Rec: 0.980 | F1: 0.980 
2025-11-14 10:45:06 | INFO |    学习率: 0.000967 -> 0.000962
2025-11-14 10:45:14 | INFO | Epoch  16/120 | 耗时: 8秒 | ETA: 15.4分钟
2025-11-14 10:45:14 | INFO |    训练 - Loss: 0.0633 | Acc: 97.60% | Prec: 0.978 | Rec: 0.974 | F1: 0.976
2025-11-14 10:45:14 | INFO |    验证 - Loss: 0.0537 | Acc: 98.00% | Prec: 0.976 | Rec: 0.984 | F1: 0.980 
2025-11-14 10:45:14 | INFO |    学习率: 0.000962 -> 0.000957
2025-11-14 10:45:23 | INFO | Epoch  17/120 | 耗时: 8秒 | ETA: 15.3分钟
2025-11-14 10:45:23 | INFO |    训练 - Loss: 0.0570 | Acc: 97.63% | Prec: 0.975 | Rec: 0.978 | F1: 0.976
2025-11-14 10:45:23 | INFO |    验证 - Loss: 0.0554 | Acc: 97.90% | Prec: 0.986 | Rec: 0.972 | F1: 0.979 
2025-11-14 10:45:23 | INFO |    学习率: 0.000957 -> 0.000951
2025-11-14 10:45:31 | INFO | Epoch  18/120 | 耗时: 8秒 | ETA: 15.1分钟
2025-11-14 10:45:31 | INFO |    训练 - Loss: 0.0662 | Acc: 97.30% | Prec: 0.974 | Rec: 0.972 | F1: 0.973
2025-11-14 10:45:31 | INFO |    验证 - Loss: 0.0805 | Acc: 96.80% | Prec: 0.994 | Rec: 0.942 | F1: 0.967 
2025-11-14 10:45:31 | INFO |    学习率: 0.000951 -> 0.000946
2025-11-14 10:45:40 | INFO | Epoch  19/120 | 耗时: 8秒 | ETA: 14.9分钟
2025-11-14 10:45:40 | INFO |    训练 - Loss: 0.0856 | Acc: 96.43% | Prec: 0.964 | Rec: 0.965 | F1: 0.964
2025-11-14 10:45:40 | INFO |    验证 - Loss: 0.0529 | Acc: 97.90% | Prec: 0.980 | Rec: 0.978 | F1: 0.979 
2025-11-14 10:45:40 | INFO |    学习率: 0.000946 -> 0.000939
2025-11-14 10:45:50 | INFO | Epoch  20/120 | 耗时: 10秒 | ETA: 14.9分钟
2025-11-14 10:45:50 | INFO |    训练 - Loss: 0.0628 | Acc: 97.37% | Prec: 0.978 | Rec: 0.969 | F1: 0.974
2025-11-14 10:45:50 | INFO |    验证 - Loss: 0.0533 | Acc: 97.80% | Prec: 0.978 | Rec: 0.978 | F1: 0.978 
2025-11-14 10:45:50 | INFO |    学习率: 0.000939 -> 0.000933
2025-11-14 10:45:59 | INFO | Epoch  21/120 | 耗时: 8秒 | ETA: 14.7分钟
2025-11-14 10:45:59 | INFO |    训练 - Loss: 0.0539 | Acc: 97.93% | Prec: 0.981 | Rec: 0.978 | F1: 0.979
2025-11-14 10:45:59 | INFO |    验证 - Loss: 0.0543 | Acc: 97.90% | Prec: 0.978 | Rec: 0.980 | F1: 0.979 
2025-11-14 10:45:59 | INFO |    学习率: 0.000933 -> 0.000926
2025-11-14 10:46:07 | INFO | Epoch  22/120 | 耗时: 8秒 | ETA: 14.5分钟
2025-11-14 10:46:07 | INFO |    训练 - Loss: 0.0591 | Acc: 97.59% | Prec: 0.979 | Rec: 0.973 | F1: 0.976
2025-11-14 10:46:07 | INFO |    验证 - Loss: 0.0585 | Acc: 98.10% | Prec: 0.992 | Rec: 0.970 | F1: 0.981 
2025-11-14 10:46:07 | INFO |    学习率: 0.000926 -> 0.000919
2025-11-14 10:46:15 | INFO | Epoch  23/120 | 耗时: 8秒 | ETA: 14.3分钟
2025-11-14 10:46:15 | INFO |    训练 - Loss: 0.0556 | Acc: 97.62% | Prec: 0.978 | Rec: 0.974 | F1: 0.976
2025-11-14 10:46:15 | INFO |    验证 - Loss: 0.0524 | Acc: 98.00% | Prec: 0.978 | Rec: 0.982 | F1: 0.980 
2025-11-14 10:46:15 | INFO |    学习率: 0.000919 -> 0.000912
2025-11-14 10:46:15 | INFO | 
触发早停 (连续 10 轮 accuracy 无改善)
2025-11-14 10:46:15 | INFO | 训练完成
2025-11-14 10:46:15 | INFO | 训练总结
2025-11-14 10:46:15 | INFO |   总耗时: 3.4分钟
2025-11-14 10:46:15 | INFO |   平均每轮: 8秒
2025-11-14 10:46:15 | INFO |   完成轮数: 23/120
2025-11-14 10:46:15 | INFO |   最佳验证: Epoch 13 - ACCURACY: 0.9810, Loss: 0.0518, Acc: 98.10%
2025-11-14 10:46:15 | INFO | 
正在测试集上评估最佳模型...
2025-11-14 10:46:15 | INFO |    已加载最佳模型 (Epoch 13)
2025-11-14 10:46:17 | INFO | 测试结果
2025-11-14 10:46:17 | INFO |   测试样本数: 1,000
2025-11-14 10:46:17 | INFO |   测试损失: 0.0574
2025-11-14 10:46:17 | INFO |   测试准确率: 98.20%
2025-11-14 10:46:17 | INFO |   测试精确率: 0.984
2025-11-14 10:46:17 | INFO |   测试召回率: 0.980
2025-11-14 10:46:17 | INFO |   测试F1: 0.982
2025-11-14 10:46:17 | INFO | 
正在生成训练曲线可视化...
2025-11-14 10:46:18 | INFO |    训练曲线已保存到: runs/torch_resnet18_20251114-104245/figures
2025-11-14 10:46:18 | INFO | 
所有任务完成!
2025-11-14 10:46:18 | INFO |    最佳模型: runs/torch_resnet18_20251114-104245/best.pt
2025-11-14 10:46:18 | INFO |    最后模型: runs/torch_resnet18_20251114-104245/last.pt
2025-11-14 10:46:18 | INFO |    TensorBoard: tensorboard --logdir=runs/torch_resnet18_20251114-104245/events

2025-11-14 10:46:18 | INFO | 训练完成
2025-11-14 10:46:18 | INFO |   耗时: 3.6分钟
2025-11-14 10:46:18 | INFO |   最佳准确率: 0.9810
2025-11-14 10:46:18 | INFO |   运行目录: runs/torch_resnet18_20251114-104245
2025-11-14 10:46:18 | INFO | RESNET18 训练流程完成
