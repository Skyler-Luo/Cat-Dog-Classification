2025-11-14 10:55:41 | INFO | 开始训练
2025-11-14 10:55:41 | INFO |   arch: resnet34
2025-11-14 10:55:41 | INFO |   data_dir: dataset
2025-11-14 10:55:41 | INFO |   batch_size: 512
2025-11-14 10:55:41 | INFO |   epochs: 120
2025-11-14 10:55:41 | INFO | 启动 RESNET34 训练流程
2025-11-14 10:55:41 | INFO | 猫狗分类 - ResNet34 训练
2025-11-14 10:55:41 | INFO | 运行环境
2025-11-14 10:55:41 | INFO |   计算设备: CUDA
2025-11-14 10:55:41 | INFO |   GPU型号: NVIDIA GeForce RTX 3090
2025-11-14 10:55:41 | INFO |   GPU内存: 23.7 GB
2025-11-14 10:55:41 | INFO |   混合精度(AMP): 启用
2025-11-14 10:55:41 | INFO | 
正在加载数据集...
2025-11-14 10:55:41 | INFO | 数据集信息
2025-11-14 10:55:41 | INFO |   训练样本数: 8,000 (88.9%)
2025-11-14 10:55:41 | INFO |   验证样本数: 1,000 (11.1%)
2025-11-14 10:55:41 | INFO |   测试样本数: 1,000
2025-11-14 10:55:41 | INFO |   类别数量: 2 (cats, dogs)
2025-11-14 10:55:41 | INFO |   每轮步数: 15
2025-11-14 10:55:41 | INFO | 模型配置
2025-11-14 10:55:41 | INFO |   模型架构: ResNet34
2025-11-14 10:55:41 | INFO |   参数总量: 21,547,841
2025-11-14 10:55:41 | INFO |   可训练参数: 263,169
2025-11-14 10:55:41 | INFO |   图像尺寸: 224x224
2025-11-14 10:55:41 | INFO |   Dropout: 0.0
2025-11-14 10:55:41 | INFO |   标准化: 默认[0,1]
2025-11-14 10:55:41 | INFO |   数据增强: 启用
2025-11-14 10:55:41 | INFO | 
计算数据集类别分布...
2025-11-14 10:55:47 | INFO | 训练配置
2025-11-14 10:55:47 | INFO |   训练轮数: 120
2025-11-14 10:55:47 | INFO |   批次大小: 512
2025-11-14 10:55:47 | INFO |   优化器: ADAM
2025-11-14 10:55:47 | INFO |   初始学习率: 0.001
2025-11-14 10:55:47 | INFO |   权重衰减: 0.0001
2025-11-14 10:55:47 | INFO |   学习率调度: cosine
2025-11-14 10:55:47 | INFO |   早停耐心值: 10
2025-11-14 10:55:47 | INFO |   早停评估指标: accuracy
2025-11-14 10:55:47 | INFO |   工作进程数: 16
2025-11-14 10:55:47 | INFO |   类别权重: cats=1.00, dogs=0.99
2025-11-14 10:55:47 | INFO | 
TensorBoard日志目录: runs/torch_resnet34_20251114-105541/events
2025-11-14 10:55:47 | INFO | 模型保存目录: runs/torch_resnet34_20251114-105541
2025-11-14 10:55:47 | INFO | 训练日志: runs/torch_resnet34_20251114-105541/resnet34.log
2025-11-14 10:55:48 | INFO | 开始训练
2025-11-14 10:56:00 | INFO | Epoch   1/120 | 耗时: 11秒 | ETA: 23.3分钟
2025-11-14 10:56:00 | INFO |    训练 - Loss: 0.2602 | Acc: 88.15% | Prec: 0.906 | Rec: 0.852 | F1: 0.878
2025-11-14 10:56:00 | INFO |    验证 - Loss: 0.0748 | Acc: 97.30% | Prec: 0.980 | Rec: 0.966 | F1: 0.973 [最佳]
2025-11-14 10:56:00 | INFO |    学习率: 0.001000 -> 0.001000
2025-11-14 10:56:10 | INFO | Epoch   2/120 | 耗时: 10秒 | ETA: 21.7分钟
2025-11-14 10:56:10 | INFO |    训练 - Loss: 0.0835 | Acc: 96.63% | Prec: 0.967 | Rec: 0.966 | F1: 0.966
2025-11-14 10:56:10 | INFO |    验证 - Loss: 0.0754 | Acc: 97.10% | Prec: 0.994 | Rec: 0.948 | F1: 0.970 
2025-11-14 10:56:10 | INFO |    学习率: 0.001000 -> 0.000999
2025-11-14 10:56:21 | INFO | Epoch   3/120 | 耗时: 10秒 | ETA: 21.0分钟
2025-11-14 10:56:21 | INFO |    训练 - Loss: 0.0669 | Acc: 97.28% | Prec: 0.973 | Rec: 0.972 | F1: 0.973
2025-11-14 10:56:21 | INFO |    验证 - Loss: 0.0464 | Acc: 98.00% | Prec: 0.988 | Rec: 0.972 | F1: 0.980 [最佳]
2025-11-14 10:56:21 | INFO |    学习率: 0.000999 -> 0.000998
2025-11-14 10:56:31 | INFO | Epoch   4/120 | 耗时: 10秒 | ETA: 20.5分钟
2025-11-14 10:56:31 | INFO |    训练 - Loss: 0.0652 | Acc: 97.23% | Prec: 0.973 | Rec: 0.972 | F1: 0.972
2025-11-14 10:56:31 | INFO |    验证 - Loss: 0.0466 | Acc: 98.10% | Prec: 0.988 | Rec: 0.974 | F1: 0.981 [最佳]
2025-11-14 10:56:31 | INFO |    学习率: 0.000998 -> 0.000997
2025-11-14 10:56:41 | INFO | Epoch   5/120 | 耗时: 10秒 | ETA: 20.1分钟
2025-11-14 10:56:41 | INFO |    训练 - Loss: 0.0653 | Acc: 97.24% | Prec: 0.972 | Rec: 0.973 | F1: 0.972
2025-11-14 10:56:41 | INFO |    验证 - Loss: 0.0437 | Acc: 97.90% | Prec: 0.986 | Rec: 0.972 | F1: 0.979 
2025-11-14 10:56:41 | INFO |    学习率: 0.000997 -> 0.000996
2025-11-14 10:56:50 | INFO | Epoch   6/120 | 耗时: 9秒 | ETA: 19.6分钟
2025-11-14 10:56:50 | INFO |    训练 - Loss: 0.0618 | Acc: 97.63% | Prec: 0.980 | Rec: 0.973 | F1: 0.976
2025-11-14 10:56:50 | INFO |    验证 - Loss: 0.0490 | Acc: 97.90% | Prec: 0.967 | Rec: 0.992 | F1: 0.979 
2025-11-14 10:56:50 | INFO |    学习率: 0.000996 -> 0.000994
2025-11-14 10:57:00 | INFO | Epoch   7/120 | 耗时: 9秒 | ETA: 19.3分钟
2025-11-14 10:57:00 | INFO |    训练 - Loss: 0.0562 | Acc: 97.71% | Prec: 0.976 | Rec: 0.978 | F1: 0.977
2025-11-14 10:57:00 | INFO |    验证 - Loss: 0.0547 | Acc: 97.90% | Prec: 0.994 | Rec: 0.964 | F1: 0.979 
2025-11-14 10:57:00 | INFO |    学习率: 0.000994 -> 0.000992
2025-11-14 10:57:10 | INFO | Epoch   8/120 | 耗时: 10秒 | ETA: 19.1分钟
2025-11-14 10:57:10 | INFO |    训练 - Loss: 0.0629 | Acc: 97.49% | Prec: 0.974 | Rec: 0.976 | F1: 0.975
2025-11-14 10:57:10 | INFO |    验证 - Loss: 0.0407 | Acc: 98.20% | Prec: 0.978 | Rec: 0.986 | F1: 0.982 [最佳]
2025-11-14 10:57:10 | INFO |    学习率: 0.000992 -> 0.000989
2025-11-14 10:57:21 | INFO | Epoch   9/120 | 耗时: 10秒 | ETA: 19.0分钟
2025-11-14 10:57:21 | INFO |    训练 - Loss: 0.0559 | Acc: 97.70% | Prec: 0.982 | Rec: 0.972 | F1: 0.977
2025-11-14 10:57:21 | INFO |    验证 - Loss: 0.0414 | Acc: 98.40% | Prec: 0.978 | Rec: 0.990 | F1: 0.984 [最佳]
2025-11-14 10:57:21 | INFO |    学习率: 0.000989 -> 0.000986
2025-11-14 10:57:33 | INFO | Epoch  10/120 | 耗时: 11秒 | ETA: 19.1分钟
2025-11-14 10:57:33 | INFO |    训练 - Loss: 0.0594 | Acc: 97.89% | Prec: 0.979 | Rec: 0.979 | F1: 0.979
2025-11-14 10:57:33 | INFO |    验证 - Loss: 0.0410 | Acc: 98.30% | Prec: 0.988 | Rec: 0.978 | F1: 0.983 
2025-11-14 10:57:33 | INFO |    学习率: 0.000986 -> 0.000983
2025-11-14 10:57:43 | INFO | Epoch  11/120 | 耗时: 10秒 | ETA: 18.9分钟
2025-11-14 10:57:43 | INFO |    训练 - Loss: 0.0536 | Acc: 97.90% | Prec: 0.978 | Rec: 0.980 | F1: 0.979
2025-11-14 10:57:43 | INFO |    验证 - Loss: 0.0429 | Acc: 98.00% | Prec: 0.990 | Rec: 0.970 | F1: 0.980 
2025-11-14 10:57:43 | INFO |    学习率: 0.000983 -> 0.000979
2025-11-14 10:57:52 | INFO | Epoch  12/120 | 耗时: 9秒 | ETA: 18.6分钟
2025-11-14 10:57:52 | INFO |    训练 - Loss: 0.0517 | Acc: 97.75% | Prec: 0.982 | Rec: 0.973 | F1: 0.977
2025-11-14 10:57:52 | INFO |    验证 - Loss: 0.0458 | Acc: 98.20% | Prec: 0.971 | Rec: 0.994 | F1: 0.982 
2025-11-14 10:57:52 | INFO |    学习率: 0.000979 -> 0.000976
2025-11-14 10:58:02 | INFO | Epoch  13/120 | 耗时: 10秒 | ETA: 18.4分钟
2025-11-14 10:58:02 | INFO |    训练 - Loss: 0.0536 | Acc: 97.71% | Prec: 0.977 | Rec: 0.977 | F1: 0.977
2025-11-14 10:58:02 | INFO |    验证 - Loss: 0.0410 | Acc: 98.30% | Prec: 0.986 | Rec: 0.980 | F1: 0.983 
2025-11-14 10:58:02 | INFO |    学习率: 0.000976 -> 0.000971
2025-11-14 10:58:13 | INFO | Epoch  14/120 | 耗时: 10秒 | ETA: 18.2分钟
2025-11-14 10:58:13 | INFO |    训练 - Loss: 0.0480 | Acc: 98.19% | Prec: 0.982 | Rec: 0.981 | F1: 0.982
2025-11-14 10:58:13 | INFO |    验证 - Loss: 0.0438 | Acc: 98.40% | Prec: 0.976 | Rec: 0.992 | F1: 0.984 
2025-11-14 10:58:13 | INFO |    学习率: 0.000971 -> 0.000967
2025-11-14 10:58:23 | INFO | Epoch  15/120 | 耗时: 9秒 | ETA: 18.0分钟
2025-11-14 10:58:23 | INFO |    训练 - Loss: 0.0519 | Acc: 97.75% | Prec: 0.978 | Rec: 0.977 | F1: 0.977
2025-11-14 10:58:23 | INFO |    验证 - Loss: 0.0438 | Acc: 98.30% | Prec: 0.992 | Rec: 0.974 | F1: 0.983 
2025-11-14 10:58:23 | INFO |    学习率: 0.000967 -> 0.000962
2025-11-14 10:58:32 | INFO | Epoch  16/120 | 耗时: 9秒 | ETA: 17.7分钟
2025-11-14 10:58:32 | INFO |    训练 - Loss: 0.0566 | Acc: 97.62% | Prec: 0.978 | Rec: 0.975 | F1: 0.976
2025-11-14 10:58:32 | INFO |    验证 - Loss: 0.0603 | Acc: 98.00% | Prec: 0.965 | Rec: 0.996 | F1: 0.980 
2025-11-14 10:58:32 | INFO |    学习率: 0.000962 -> 0.000957
2025-11-14 10:58:42 | INFO | Epoch  17/120 | 耗时: 9秒 | ETA: 17.5分钟
2025-11-14 10:58:42 | INFO |    训练 - Loss: 0.0546 | Acc: 97.71% | Prec: 0.979 | Rec: 0.975 | F1: 0.977
2025-11-14 10:58:42 | INFO |    验证 - Loss: 0.0414 | Acc: 98.20% | Prec: 0.990 | Rec: 0.974 | F1: 0.982 
2025-11-14 10:58:42 | INFO |    学习率: 0.000957 -> 0.000951
2025-11-14 10:58:51 | INFO | Epoch  18/120 | 耗时: 9秒 | ETA: 17.3分钟
2025-11-14 10:58:51 | INFO |    训练 - Loss: 0.0459 | Acc: 98.14% | Prec: 0.979 | Rec: 0.984 | F1: 0.981
2025-11-14 10:58:51 | INFO |    验证 - Loss: 0.0381 | Acc: 98.30% | Prec: 0.988 | Rec: 0.978 | F1: 0.983 
2025-11-14 10:58:51 | INFO |    学习率: 0.000951 -> 0.000946
2025-11-14 10:59:02 | INFO | Epoch  19/120 | 耗时: 10秒 | ETA: 17.1分钟
2025-11-14 10:59:02 | INFO |    训练 - Loss: 0.0506 | Acc: 98.01% | Prec: 0.980 | Rec: 0.980 | F1: 0.980
2025-11-14 10:59:02 | INFO |    验证 - Loss: 0.0411 | Acc: 98.60% | Prec: 0.980 | Rec: 0.992 | F1: 0.986 [最佳]
2025-11-14 10:59:02 | INFO |    学习率: 0.000946 -> 0.000939
2025-11-14 10:59:13 | INFO | Epoch  20/120 | 耗时: 11秒 | ETA: 17.1分钟
2025-11-14 10:59:13 | INFO |    训练 - Loss: 0.0472 | Acc: 98.11% | Prec: 0.984 | Rec: 0.979 | F1: 0.981
2025-11-14 10:59:13 | INFO |    验证 - Loss: 0.0379 | Acc: 98.50% | Prec: 0.984 | Rec: 0.986 | F1: 0.985 
2025-11-14 10:59:13 | INFO |    学习率: 0.000939 -> 0.000933
2025-11-14 10:59:24 | INFO | Epoch  21/120 | 耗时: 10秒 | ETA: 16.9分钟
2025-11-14 10:59:24 | INFO |    训练 - Loss: 0.0455 | Acc: 97.92% | Prec: 0.978 | Rec: 0.980 | F1: 0.979
2025-11-14 10:59:24 | INFO |    验证 - Loss: 0.0365 | Acc: 98.50% | Prec: 0.986 | Rec: 0.984 | F1: 0.985 
2025-11-14 10:59:24 | INFO |    学习率: 0.000933 -> 0.000926
2025-11-14 10:59:33 | INFO | Epoch  22/120 | 耗时: 9秒 | ETA: 16.7分钟
2025-11-14 10:59:33 | INFO |    训练 - Loss: 0.0441 | Acc: 98.18% | Prec: 0.983 | Rec: 0.981 | F1: 0.982
2025-11-14 10:59:33 | INFO |    验证 - Loss: 0.0386 | Acc: 98.50% | Prec: 0.992 | Rec: 0.978 | F1: 0.985 
2025-11-14 10:59:33 | INFO |    学习率: 0.000926 -> 0.000919
2025-11-14 10:59:43 | INFO | Epoch  23/120 | 耗时: 9秒 | ETA: 16.5分钟
2025-11-14 10:59:43 | INFO |    训练 - Loss: 0.0471 | Acc: 98.10% | Prec: 0.980 | Rec: 0.982 | F1: 0.981
2025-11-14 10:59:43 | INFO |    验证 - Loss: 0.0387 | Acc: 98.40% | Prec: 0.988 | Rec: 0.980 | F1: 0.984 
2025-11-14 10:59:43 | INFO |    学习率: 0.000919 -> 0.000912
2025-11-14 10:59:53 | INFO | Epoch  24/120 | 耗时: 9秒 | ETA: 16.3分钟
2025-11-14 10:59:53 | INFO |    训练 - Loss: 0.0435 | Acc: 98.24% | Prec: 0.983 | Rec: 0.982 | F1: 0.982
2025-11-14 10:59:53 | INFO |    验证 - Loss: 0.0387 | Acc: 98.20% | Prec: 0.990 | Rec: 0.974 | F1: 0.982 
2025-11-14 10:59:53 | INFO |    学习率: 0.000912 -> 0.000905
2025-11-14 11:00:02 | INFO | Epoch  25/120 | 耗时: 9秒 | ETA: 16.1分钟
2025-11-14 11:00:02 | INFO |    训练 - Loss: 0.0495 | Acc: 98.01% | Prec: 0.985 | Rec: 0.975 | F1: 0.980
2025-11-14 11:00:02 | INFO |    验证 - Loss: 0.0386 | Acc: 98.40% | Prec: 0.978 | Rec: 0.990 | F1: 0.984 
2025-11-14 11:00:02 | INFO |    学习率: 0.000905 -> 0.000897
2025-11-14 11:00:13 | INFO | Epoch  26/120 | 耗时: 10秒 | ETA: 15.9分钟
2025-11-14 11:00:13 | INFO |    训练 - Loss: 0.0568 | Acc: 97.70% | Prec: 0.975 | Rec: 0.979 | F1: 0.977
2025-11-14 11:00:13 | INFO |    验证 - Loss: 0.0565 | Acc: 97.80% | Prec: 0.994 | Rec: 0.962 | F1: 0.978 
2025-11-14 11:00:13 | INFO |    学习率: 0.000897 -> 0.000889
2025-11-14 11:00:22 | INFO | Epoch  27/120 | 耗时: 9秒 | ETA: 15.7分钟
2025-11-14 11:00:22 | INFO |    训练 - Loss: 0.0464 | Acc: 98.09% | Prec: 0.984 | Rec: 0.977 | F1: 0.981
2025-11-14 11:00:22 | INFO |    验证 - Loss: 0.0457 | Acc: 98.20% | Prec: 0.971 | Rec: 0.994 | F1: 0.982 
2025-11-14 11:00:22 | INFO |    学习率: 0.000889 -> 0.000880
2025-11-14 11:00:32 | INFO | Epoch  28/120 | 耗时: 10秒 | ETA: 15.6分钟
2025-11-14 11:00:32 | INFO |    训练 - Loss: 0.0436 | Acc: 98.27% | Prec: 0.982 | Rec: 0.984 | F1: 0.983
2025-11-14 11:00:32 | INFO |    验证 - Loss: 0.0395 | Acc: 98.60% | Prec: 0.990 | Rec: 0.982 | F1: 0.986 
2025-11-14 11:00:32 | INFO |    学习率: 0.000880 -> 0.000872
2025-11-14 11:00:43 | INFO | Epoch  29/120 | 耗时: 10秒 | ETA: 15.4分钟
2025-11-14 11:00:43 | INFO |    训练 - Loss: 0.0441 | Acc: 98.31% | Prec: 0.984 | Rec: 0.982 | F1: 0.983
2025-11-14 11:00:43 | INFO |    验证 - Loss: 0.0407 | Acc: 98.40% | Prec: 0.978 | Rec: 0.990 | F1: 0.984 
2025-11-14 11:00:43 | INFO |    学习率: 0.000872 -> 0.000863
2025-11-14 11:00:43 | INFO | 
触发早停 (连续 10 轮 accuracy 无改善)
2025-11-14 11:00:43 | INFO | 训练完成
2025-11-14 11:00:43 | INFO | 训练总结
2025-11-14 11:00:43 | INFO |   总耗时: 4.9分钟
2025-11-14 11:00:43 | INFO |   平均每轮: 10秒
2025-11-14 11:00:43 | INFO |   完成轮数: 29/120
2025-11-14 11:00:43 | INFO |   最佳验证: Epoch 19 - ACCURACY: 0.9860, Loss: 0.0411, Acc: 98.60%
2025-11-14 11:00:43 | INFO | 
正在测试集上评估最佳模型...
2025-11-14 11:00:43 | INFO |    已加载最佳模型 (Epoch 19)
2025-11-14 11:00:44 | INFO | 测试结果
2025-11-14 11:00:44 | INFO |   测试样本数: 1,000
2025-11-14 11:00:44 | INFO |   测试损失: 0.0544
2025-11-14 11:00:44 | INFO |   测试准确率: 98.30%
2025-11-14 11:00:44 | INFO |   测试精确率: 0.973
2025-11-14 11:00:44 | INFO |   测试召回率: 0.994
2025-11-14 11:00:44 | INFO |   测试F1: 0.983
2025-11-14 11:00:44 | INFO | 
正在生成训练曲线可视化...
2025-11-14 11:00:45 | INFO |    训练曲线已保存到: runs/torch_resnet34_20251114-105541/figures
2025-11-14 11:00:45 | INFO | 
所有任务完成!
2025-11-14 11:00:45 | INFO |    最佳模型: runs/torch_resnet34_20251114-105541/best.pt
2025-11-14 11:00:45 | INFO |    最后模型: runs/torch_resnet34_20251114-105541/last.pt
2025-11-14 11:00:45 | INFO |    TensorBoard: tensorboard --logdir=runs/torch_resnet34_20251114-105541/events

2025-11-14 11:00:45 | INFO | 训练完成
2025-11-14 11:00:45 | INFO |   耗时: 5.1分钟
2025-11-14 11:00:45 | INFO |   最佳准确率: 0.9860
2025-11-14 11:00:45 | INFO |   运行目录: runs/torch_resnet34_20251114-105541
2025-11-14 11:00:45 | INFO | RESNET34 训练流程完成
