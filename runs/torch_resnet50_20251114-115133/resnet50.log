2025-11-14 11:51:33 | INFO | 开始训练
2025-11-14 11:51:33 | INFO |   arch: resnet50
2025-11-14 11:51:33 | INFO |   data_dir: dataset
2025-11-14 11:51:33 | INFO |   batch_size: 512
2025-11-14 11:51:33 | INFO |   epochs: 120
2025-11-14 11:51:33 | INFO | 启动 RESNET50 训练流程
2025-11-14 11:51:33 | INFO | 猫狗分类 - ResNet50 训练
2025-11-14 11:51:33 | INFO | 运行环境
2025-11-14 11:51:33 | INFO |   计算设备: CUDA
2025-11-14 11:51:33 | INFO |   GPU型号: NVIDIA GeForce RTX 3090
2025-11-14 11:51:33 | INFO |   GPU内存: 23.7 GB
2025-11-14 11:51:33 | INFO |   混合精度(AMP): 启用
2025-11-14 11:51:33 | INFO | 
正在加载数据集...
2025-11-14 11:51:33 | INFO | 数据集信息
2025-11-14 11:51:33 | INFO |   训练样本数: 8,000 (88.9%)
2025-11-14 11:51:33 | INFO |   验证样本数: 1,000 (11.1%)
2025-11-14 11:51:33 | INFO |   测试样本数: 1,000
2025-11-14 11:51:33 | INFO |   类别数量: 2 (cats, dogs)
2025-11-14 11:51:33 | INFO |   每轮步数: 15
2025-11-14 11:51:44 | INFO | 模型配置
2025-11-14 11:51:44 | INFO |   模型架构: ResNet50
2025-11-14 11:51:44 | INFO |   参数总量: 24,557,633
2025-11-14 11:51:44 | INFO |   可训练参数: 1,049,601
2025-11-14 11:51:44 | INFO |   图像尺寸: 224x224
2025-11-14 11:51:44 | INFO |   Dropout: 0.0
2025-11-14 11:51:44 | INFO |   标准化: 默认[0,1]
2025-11-14 11:51:44 | INFO |   数据增强: 启用
2025-11-14 11:51:44 | INFO | 
计算数据集类别分布...
2025-11-14 11:51:49 | INFO | 训练配置
2025-11-14 11:51:49 | INFO |   训练轮数: 120
2025-11-14 11:51:49 | INFO |   批次大小: 512
2025-11-14 11:51:49 | INFO |   优化器: ADAM
2025-11-14 11:51:49 | INFO |   初始学习率: 0.001
2025-11-14 11:51:49 | INFO |   权重衰减: 0.0001
2025-11-14 11:51:49 | INFO |   学习率调度: cosine
2025-11-14 11:51:49 | INFO |   早停耐心值: 10
2025-11-14 11:51:49 | INFO |   早停评估指标: accuracy
2025-11-14 11:51:49 | INFO |   工作进程数: 16
2025-11-14 11:51:49 | INFO |   类别权重: cats=1.00, dogs=1.01
2025-11-14 11:51:49 | INFO | 
TensorBoard日志目录: runs/torch_resnet50_20251114-115133/events
2025-11-14 11:51:49 | INFO | 模型保存目录: runs/torch_resnet50_20251114-115133
2025-11-14 11:51:49 | INFO | 训练日志: runs/torch_resnet50_20251114-115133/resnet50.log
2025-11-14 11:51:50 | INFO | 开始训练
2025-11-14 11:52:05 | INFO | Epoch   1/120 | 耗时: 14秒 | ETA: 29.7分钟
2025-11-14 11:52:05 | INFO |    训练 - Loss: 0.4038 | Acc: 79.21% | Prec: 0.805 | Rec: 0.772 | F1: 0.788
2025-11-14 11:52:05 | INFO |    验证 - Loss: 0.1734 | Acc: 92.10% | Prec: 0.995 | Rec: 0.846 | F1: 0.915 [最佳]
2025-11-14 11:52:05 | INFO |    学习率: 0.001000 -> 0.001000
2025-11-14 11:52:20 | INFO | Epoch   2/120 | 耗时: 14秒 | ETA: 29.2分钟
2025-11-14 11:52:20 | INFO |    训练 - Loss: 0.1105 | Acc: 95.62% | Prec: 0.955 | Rec: 0.958 | F1: 0.956
2025-11-14 11:52:20 | INFO |    验证 - Loss: 0.0544 | Acc: 98.00% | Prec: 0.971 | Rec: 0.990 | F1: 0.980 [最佳]
2025-11-14 11:52:20 | INFO |    学习率: 0.001000 -> 0.000999
2025-11-14 11:52:34 | INFO | Epoch   3/120 | 耗时: 13秒 | ETA: 28.2分钟
2025-11-14 11:52:34 | INFO |    训练 - Loss: 0.0759 | Acc: 97.12% | Prec: 0.969 | Rec: 0.973 | F1: 0.971
2025-11-14 11:52:34 | INFO |    验证 - Loss: 0.0446 | Acc: 98.40% | Prec: 0.984 | Rec: 0.984 | F1: 0.984 [最佳]
2025-11-14 11:52:34 | INFO |    学习率: 0.000999 -> 0.000998
2025-11-14 11:52:47 | INFO | Epoch   4/120 | 耗时: 13秒 | ETA: 27.3分钟
2025-11-14 11:52:47 | INFO |    训练 - Loss: 0.0676 | Acc: 97.38% | Prec: 0.974 | Rec: 0.974 | F1: 0.974
2025-11-14 11:52:47 | INFO |    验证 - Loss: 0.0420 | Acc: 98.40% | Prec: 0.986 | Rec: 0.982 | F1: 0.984 
2025-11-14 11:52:47 | INFO |    学习率: 0.000998 -> 0.000997
2025-11-14 11:53:02 | INFO | Epoch   5/120 | 耗时: 14秒 | ETA: 27.3分钟
2025-11-14 11:53:02 | INFO |    训练 - Loss: 0.0665 | Acc: 97.43% | Prec: 0.976 | Rec: 0.973 | F1: 0.974
2025-11-14 11:53:02 | INFO |    验证 - Loss: 0.0408 | Acc: 98.60% | Prec: 0.982 | Rec: 0.990 | F1: 0.986 [最佳]
2025-11-14 11:53:02 | INFO |    学习率: 0.000997 -> 0.000996
2025-11-14 11:53:16 | INFO | Epoch   6/120 | 耗时: 13秒 | ETA: 27.0分钟
2025-11-14 11:53:16 | INFO |    训练 - Loss: 0.0612 | Acc: 97.57% | Prec: 0.975 | Rec: 0.977 | F1: 0.976
2025-11-14 11:53:16 | INFO |    验证 - Loss: 0.0390 | Acc: 98.70% | Prec: 0.994 | Rec: 0.980 | F1: 0.987 [最佳]
2025-11-14 11:53:16 | INFO |    学习率: 0.000996 -> 0.000994
2025-11-14 11:53:29 | INFO | Epoch   7/120 | 耗时: 13秒 | ETA: 26.6分钟
2025-11-14 11:53:29 | INFO |    训练 - Loss: 0.0566 | Acc: 97.79% | Prec: 0.982 | Rec: 0.974 | F1: 0.978
2025-11-14 11:53:29 | INFO |    验证 - Loss: 0.0378 | Acc: 98.80% | Prec: 0.982 | Rec: 0.994 | F1: 0.988 [最佳]
2025-11-14 11:53:29 | INFO |    学习率: 0.000994 -> 0.000992
2025-11-14 11:53:43 | INFO | Epoch   8/120 | 耗时: 13秒 | ETA: 26.3分钟
2025-11-14 11:53:43 | INFO |    训练 - Loss: 0.0558 | Acc: 97.83% | Prec: 0.977 | Rec: 0.979 | F1: 0.978
2025-11-14 11:53:43 | INFO |    验证 - Loss: 0.0355 | Acc: 98.60% | Prec: 0.994 | Rec: 0.978 | F1: 0.986 
2025-11-14 11:53:43 | INFO |    学习率: 0.000992 -> 0.000989
2025-11-14 11:53:56 | INFO | Epoch   9/120 | 耗时: 13秒 | ETA: 25.9分钟
2025-11-14 11:53:56 | INFO |    训练 - Loss: 0.0488 | Acc: 98.10% | Prec: 0.980 | Rec: 0.982 | F1: 0.981
2025-11-14 11:53:56 | INFO |    验证 - Loss: 0.0334 | Acc: 98.80% | Prec: 0.984 | Rec: 0.992 | F1: 0.988 
2025-11-14 11:53:56 | INFO |    学习率: 0.000989 -> 0.000986
2025-11-14 11:54:12 | INFO | Epoch  10/120 | 耗时: 16秒 | ETA: 26.0分钟
2025-11-14 11:54:12 | INFO |    训练 - Loss: 0.0523 | Acc: 97.99% | Prec: 0.980 | Rec: 0.980 | F1: 0.980
2025-11-14 11:54:12 | INFO |    验证 - Loss: 0.0369 | Acc: 98.50% | Prec: 0.996 | Rec: 0.974 | F1: 0.985 
2025-11-14 11:54:12 | INFO |    学习率: 0.000986 -> 0.000983
2025-11-14 11:54:26 | INFO | Epoch  11/120 | 耗时: 13秒 | ETA: 25.7分钟
2025-11-14 11:54:26 | INFO |    训练 - Loss: 0.0490 | Acc: 97.89% | Prec: 0.981 | Rec: 0.977 | F1: 0.979
2025-11-14 11:54:26 | INFO |    验证 - Loss: 0.0325 | Acc: 98.70% | Prec: 0.994 | Rec: 0.980 | F1: 0.987 
2025-11-14 11:54:26 | INFO |    学习率: 0.000983 -> 0.000979
2025-11-14 11:54:41 | INFO | Epoch  12/120 | 耗时: 14秒 | ETA: 25.6分钟
2025-11-14 11:54:41 | INFO |    训练 - Loss: 0.0463 | Acc: 98.18% | Prec: 0.983 | Rec: 0.981 | F1: 0.982
2025-11-14 11:54:41 | INFO |    验证 - Loss: 0.0300 | Acc: 98.90% | Prec: 0.990 | Rec: 0.988 | F1: 0.989 [最佳]
2025-11-14 11:54:41 | INFO |    学习率: 0.000979 -> 0.000976
2025-11-14 11:54:55 | INFO | Epoch  13/120 | 耗时: 14秒 | ETA: 25.3分钟
2025-11-14 11:54:55 | INFO |    训练 - Loss: 0.0438 | Acc: 98.35% | Prec: 0.984 | Rec: 0.983 | F1: 0.983
2025-11-14 11:54:55 | INFO |    验证 - Loss: 0.0297 | Acc: 99.10% | Prec: 0.988 | Rec: 0.994 | F1: 0.991 [最佳]
2025-11-14 11:54:55 | INFO |    学习率: 0.000976 -> 0.000971
2025-11-14 11:55:08 | INFO | Epoch  14/120 | 耗时: 13秒 | ETA: 25.0分钟
2025-11-14 11:55:08 | INFO |    训练 - Loss: 0.0464 | Acc: 98.07% | Prec: 0.980 | Rec: 0.981 | F1: 0.981
2025-11-14 11:55:08 | INFO |    验证 - Loss: 0.0271 | Acc: 99.00% | Prec: 0.988 | Rec: 0.992 | F1: 0.990 
2025-11-14 11:55:08 | INFO |    学习率: 0.000971 -> 0.000967
2025-11-14 11:55:21 | INFO | Epoch  15/120 | 耗时: 12秒 | ETA: 24.6分钟
2025-11-14 11:55:21 | INFO |    训练 - Loss: 0.0456 | Acc: 98.24% | Prec: 0.985 | Rec: 0.979 | F1: 0.982
2025-11-14 11:55:21 | INFO |    验证 - Loss: 0.0324 | Acc: 98.50% | Prec: 0.996 | Rec: 0.974 | F1: 0.985 
2025-11-14 11:55:21 | INFO |    学习率: 0.000967 -> 0.000962
2025-11-14 11:55:35 | INFO | Epoch  16/120 | 耗时: 13秒 | ETA: 24.3分钟
2025-11-14 11:55:35 | INFO |    训练 - Loss: 0.0485 | Acc: 98.07% | Prec: 0.983 | Rec: 0.979 | F1: 0.981
2025-11-14 11:55:35 | INFO |    验证 - Loss: 0.0281 | Acc: 98.80% | Prec: 0.984 | Rec: 0.992 | F1: 0.988 
2025-11-14 11:55:35 | INFO |    学习率: 0.000962 -> 0.000957
2025-11-14 11:55:48 | INFO | Epoch  17/120 | 耗时: 13秒 | ETA: 24.0分钟
2025-11-14 11:55:48 | INFO |    训练 - Loss: 0.0473 | Acc: 98.20% | Prec: 0.984 | Rec: 0.980 | F1: 0.982
2025-11-14 11:55:48 | INFO |    验证 - Loss: 0.0272 | Acc: 98.80% | Prec: 0.984 | Rec: 0.992 | F1: 0.988 
2025-11-14 11:55:48 | INFO |    学习率: 0.000957 -> 0.000951
2025-11-14 11:56:02 | INFO | Epoch  18/120 | 耗时: 14秒 | ETA: 23.8分钟
2025-11-14 11:56:02 | INFO |    训练 - Loss: 0.0425 | Acc: 98.48% | Prec: 0.985 | Rec: 0.985 | F1: 0.985
2025-11-14 11:56:02 | INFO |    验证 - Loss: 0.0268 | Acc: 98.90% | Prec: 0.986 | Rec: 0.992 | F1: 0.989 
2025-11-14 11:56:02 | INFO |    学习率: 0.000951 -> 0.000946
2025-11-14 11:56:16 | INFO | Epoch  19/120 | 耗时: 13秒 | ETA: 23.5分钟
2025-11-14 11:56:16 | INFO |    训练 - Loss: 0.0473 | Acc: 98.16% | Prec: 0.984 | Rec: 0.980 | F1: 0.982
2025-11-14 11:56:16 | INFO |    验证 - Loss: 0.0258 | Acc: 99.10% | Prec: 0.994 | Rec: 0.988 | F1: 0.991 
2025-11-14 11:56:16 | INFO |    学习率: 0.000946 -> 0.000939
2025-11-14 11:56:31 | INFO | Epoch  20/120 | 耗时: 15秒 | ETA: 23.4分钟
2025-11-14 11:56:31 | INFO |    训练 - Loss: 0.0446 | Acc: 98.26% | Prec: 0.984 | Rec: 0.981 | F1: 0.982
2025-11-14 11:56:31 | INFO |    验证 - Loss: 0.0296 | Acc: 98.90% | Prec: 0.998 | Rec: 0.980 | F1: 0.989 
2025-11-14 11:56:31 | INFO |    学习率: 0.000939 -> 0.000933
2025-11-14 11:56:44 | INFO | Epoch  21/120 | 耗时: 12秒 | ETA: 23.0分钟
2025-11-14 11:56:44 | INFO |    训练 - Loss: 0.0448 | Acc: 98.29% | Prec: 0.983 | Rec: 0.983 | F1: 0.983
2025-11-14 11:56:44 | INFO |    验证 - Loss: 0.0249 | Acc: 98.90% | Prec: 0.990 | Rec: 0.988 | F1: 0.989 
2025-11-14 11:56:44 | INFO |    学习率: 0.000933 -> 0.000926
2025-11-14 11:56:57 | INFO | Epoch  22/120 | 耗时: 13秒 | ETA: 22.8分钟
2025-11-14 11:56:57 | INFO |    训练 - Loss: 0.0535 | Acc: 97.90% | Prec: 0.980 | Rec: 0.978 | F1: 0.979
2025-11-14 11:56:57 | INFO |    验证 - Loss: 0.0328 | Acc: 98.50% | Prec: 0.976 | Rec: 0.994 | F1: 0.985 
2025-11-14 11:56:57 | INFO |    学习率: 0.000926 -> 0.000919
2025-11-14 11:57:11 | INFO | Epoch  23/120 | 耗时: 13秒 | ETA: 22.5分钟
2025-11-14 11:57:11 | INFO |    训练 - Loss: 0.0470 | Acc: 98.18% | Prec: 0.983 | Rec: 0.980 | F1: 0.982
2025-11-14 11:57:11 | INFO |    验证 - Loss: 0.0250 | Acc: 99.20% | Prec: 0.998 | Rec: 0.986 | F1: 0.992 [最佳]
2025-11-14 11:57:11 | INFO |    学习率: 0.000919 -> 0.000912
2025-11-14 11:57:24 | INFO | Epoch  24/120 | 耗时: 13秒 | ETA: 22.2分钟
2025-11-14 11:57:24 | INFO |    训练 - Loss: 0.0509 | Acc: 98.05% | Prec: 0.981 | Rec: 0.979 | F1: 0.980
2025-11-14 11:57:24 | INFO |    验证 - Loss: 0.0238 | Acc: 99.10% | Prec: 0.994 | Rec: 0.988 | F1: 0.991 
2025-11-14 11:57:24 | INFO |    学习率: 0.000912 -> 0.000905
2025-11-14 11:57:37 | INFO | Epoch  25/120 | 耗时: 13秒 | ETA: 22.0分钟
2025-11-14 11:57:37 | INFO |    训练 - Loss: 0.0353 | Acc: 98.70% | Prec: 0.989 | Rec: 0.985 | F1: 0.987
2025-11-14 11:57:37 | INFO |    验证 - Loss: 0.0244 | Acc: 99.00% | Prec: 0.992 | Rec: 0.988 | F1: 0.990 
2025-11-14 11:57:37 | INFO |    学习率: 0.000905 -> 0.000897
2025-11-14 11:57:50 | INFO | Epoch  26/120 | 耗时: 13秒 | ETA: 21.7分钟
2025-11-14 11:57:50 | INFO |    训练 - Loss: 0.0408 | Acc: 98.36% | Prec: 0.984 | Rec: 0.984 | F1: 0.984
2025-11-14 11:57:50 | INFO |    验证 - Loss: 0.0260 | Acc: 98.70% | Prec: 0.984 | Rec: 0.990 | F1: 0.987 
2025-11-14 11:57:50 | INFO |    学习率: 0.000897 -> 0.000889
2025-11-14 11:58:05 | INFO | Epoch  27/120 | 耗时: 14秒 | ETA: 21.5分钟
2025-11-14 11:58:05 | INFO |    训练 - Loss: 0.0424 | Acc: 98.23% | Prec: 0.984 | Rec: 0.981 | F1: 0.982
2025-11-14 11:58:05 | INFO |    验证 - Loss: 0.0332 | Acc: 98.60% | Prec: 0.978 | Rec: 0.994 | F1: 0.986 
2025-11-14 11:58:05 | INFO |    学习率: 0.000889 -> 0.000880
2025-11-14 11:58:18 | INFO | Epoch  28/120 | 耗时: 12秒 | ETA: 21.2分钟
2025-11-14 11:58:18 | INFO |    训练 - Loss: 0.0398 | Acc: 98.32% | Prec: 0.981 | Rec: 0.985 | F1: 0.983
2025-11-14 11:58:18 | INFO |    验证 - Loss: 0.0419 | Acc: 98.50% | Prec: 0.998 | Rec: 0.972 | F1: 0.985 
2025-11-14 11:58:18 | INFO |    学习率: 0.000880 -> 0.000872
2025-11-14 11:58:31 | INFO | Epoch  29/120 | 耗时: 12秒 | ETA: 20.9分钟
2025-11-14 11:58:31 | INFO |    训练 - Loss: 0.0626 | Acc: 97.63% | Prec: 0.976 | Rec: 0.977 | F1: 0.976
2025-11-14 11:58:31 | INFO |    验证 - Loss: 0.0343 | Acc: 98.60% | Prec: 0.976 | Rec: 0.996 | F1: 0.986 
2025-11-14 11:58:31 | INFO |    学习率: 0.000872 -> 0.000863
2025-11-14 11:58:46 | INFO | Epoch  30/120 | 耗时: 15秒 | ETA: 20.8分钟
2025-11-14 11:58:46 | INFO |    训练 - Loss: 0.0501 | Acc: 98.14% | Prec: 0.985 | Rec: 0.978 | F1: 0.981
2025-11-14 11:58:46 | INFO |    验证 - Loss: 0.0237 | Acc: 99.20% | Prec: 0.996 | Rec: 0.988 | F1: 0.992 
2025-11-14 11:58:46 | INFO |    学习率: 0.000863 -> 0.000854
2025-11-14 11:58:59 | INFO | Epoch  31/120 | 耗时: 13秒 | ETA: 20.5分钟
2025-11-14 11:58:59 | INFO |    训练 - Loss: 0.0429 | Acc: 98.36% | Prec: 0.983 | Rec: 0.985 | F1: 0.984
2025-11-14 11:58:59 | INFO |    验证 - Loss: 0.0290 | Acc: 98.80% | Prec: 0.996 | Rec: 0.980 | F1: 0.988 
2025-11-14 11:58:59 | INFO |    学习率: 0.000854 -> 0.000844
2025-11-14 11:59:13 | INFO | Epoch  32/120 | 耗时: 14秒 | ETA: 20.3分钟
2025-11-14 11:59:13 | INFO |    训练 - Loss: 0.0453 | Acc: 98.31% | Prec: 0.985 | Rec: 0.982 | F1: 0.983
2025-11-14 11:59:13 | INFO |    验证 - Loss: 0.0236 | Acc: 98.80% | Prec: 0.990 | Rec: 0.986 | F1: 0.988 
2025-11-14 11:59:13 | INFO |    学习率: 0.000844 -> 0.000835
2025-11-14 11:59:26 | INFO | Epoch  33/120 | 耗时: 13秒 | ETA: 20.0分钟
2025-11-14 11:59:26 | INFO |    训练 - Loss: 0.0320 | Acc: 98.84% | Prec: 0.990 | Rec: 0.987 | F1: 0.988
2025-11-14 11:59:26 | INFO |    验证 - Loss: 0.0267 | Acc: 98.90% | Prec: 0.996 | Rec: 0.982 | F1: 0.989 
2025-11-14 11:59:26 | INFO |    学习率: 0.000835 -> 0.000825
2025-11-14 11:59:26 | INFO | 
触发早停 (连续 10 轮 accuracy 无改善)
2025-11-14 11:59:26 | INFO | 训练完成
2025-11-14 11:59:26 | INFO | 训练总结
2025-11-14 11:59:26 | INFO |   总耗时: 7.6分钟
2025-11-14 11:59:26 | INFO |   平均每轮: 13秒
2025-11-14 11:59:26 | INFO |   完成轮数: 33/120
2025-11-14 11:59:26 | INFO |   最佳验证: Epoch 23 - ACCURACY: 0.9920, Loss: 0.0250, Acc: 99.20%
2025-11-14 11:59:26 | INFO | 
正在测试集上评估最佳模型...
2025-11-14 11:59:26 | INFO |    已加载最佳模型 (Epoch 23)
2025-11-14 11:59:28 | INFO | 测试结果
2025-11-14 11:59:28 | INFO |   测试样本数: 1,000
2025-11-14 11:59:28 | INFO |   测试损失: 0.0451
2025-11-14 11:59:28 | INFO |   测试准确率: 98.40%
2025-11-14 11:59:28 | INFO |   测试精确率: 0.986
2025-11-14 11:59:28 | INFO |   测试召回率: 0.982
2025-11-14 11:59:28 | INFO |   测试F1: 0.984
2025-11-14 11:59:28 | INFO | 
正在生成训练曲线可视化...
2025-11-14 11:59:30 | INFO |    训练曲线已保存到: runs/torch_resnet50_20251114-115133/figures
2025-11-14 11:59:30 | INFO | 
所有任务完成!
2025-11-14 11:59:30 | INFO |    最佳模型: runs/torch_resnet50_20251114-115133/best.pt
2025-11-14 11:59:30 | INFO |    最后模型: runs/torch_resnet50_20251114-115133/last.pt
2025-11-14 11:59:30 | INFO |    TensorBoard: tensorboard --logdir=runs/torch_resnet50_20251114-115133/events

2025-11-14 11:59:30 | INFO | 训练完成
2025-11-14 11:59:30 | INFO |   耗时: 7.9分钟
2025-11-14 11:59:30 | INFO |   最佳准确率: 0.9920
2025-11-14 11:59:30 | INFO |   运行目录: runs/torch_resnet50_20251114-115133
2025-11-14 11:59:30 | INFO | RESNET50 训练流程完成
